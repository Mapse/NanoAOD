//*****************************************************************************
// ---- method called for each event to check good minimum bias trigger ---- //
//*****************************************************************************

bool NanoAnalyzer::providesGoodMinBiasTrigger(const edm::Event& iEvent) {

// *************************************************************
//------------------ get and check trigger info ----------------
// *************************************************************

#ifndef CMSSW7plus 
                edm::Handle<edm::TriggerResults> triggerResults;
                edm::Handle<edm::TriggerResults> triggerResultsHandle_;
                edm::InputTag trigResultsTag("TriggerResults","","HLT"); 
                iEvent.getByLabel(trigResultsTag,triggerResultsHandle_);
#endif
#ifdef CMSSW7plus
  //EDGetTokenT<edm::TriggerResults> trigTkn;
  //trigTkn = consumes< edm::TriggerResults>(edm::InputTag("TriggerResults","","HLT"));
  edm::Handle<edm::TriggerResults> triggerResultsHandle_;  
  iEvent.getByToken(trigTkn, triggerResultsHandle_);  
#endif

                // check whether trigger info was obtained successfully
                if (!triggerResultsHandle_.isValid()) {
		  std::cout << "Nano::goodTrigger: Error in getting TriggerResults product from Event!" << std::endl;
                  return false;
                }

                // get trigger names
                const edm::TriggerNames& trigNames = iEvent.triggerNames(*triggerResultsHandle_); 

//                // dump trigger information including accept flag
//                for(unsigned i= 0; i<trigNames.size(); i++) { 
//                  if (triggerResultsHandle_->accept(i)==1){
//                    std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
//                    std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
//      	    }
//                } 


                // Physically relevant ZeroBias datasets for Run 1 are available
                // in 2010 A only (run < 145000)
                    // BPTX based (actually MinimumBias)
		//            HLT_L1_BPTX_MinusOnly
                //            HLT_L1_BPTX_PlusOnly
                //            HLT_L1_BPTX
                    // real ZeroBias
                //            HLT_ZeroBias
                //            HLT_Random

		// There are four categories of triggers in the MinimumBias dataset of 2010 Run B:
                //
                // 1) ~60% Minimum-bias-like triggers (some tagger requirements or random triggers)
                //            HLT_L1_BPTX_MinusOnly
                //            HLT_L1_BPTX_PlusOnly
                //            HLT_L1_BPTX
                //            HLT_ZeroBias
                //            HLT_Random
                //       
                // 2) ~10% large track multiplicity triggers (three subcategories: >75, 85, 100 tracks)
                //    for "ridge" studies
                //            HLT_PixelTracks_Multiplicity100
                //            HLT_PixelTracks_Multiplicity85
                //            HLT_PixelTracks_Multiplicity70
                // 2a)     Beam scintillator (BSC) based high multiplicity trigger (all segments of BSC fire)         
                //            HLT_L1Tech_BSC_HighMultiplicity
                // 
                // 3) ~28% triggers for exotic stopped High mass Stable Charged Particles (out of time, out of beam(?))
                //            HLT_StoppedHSCP35_v3
                //            HLT_StoppedHSCP20_v3
                //            HLT_StoppedHSCP_v2       *** added ***
                //            HLT_StoppedHSCP
                //
                //    also useful for exclusive diffraction?? (check for J/psis)
                //
                // 4) ~2%, a technical "muon" (RPC based) trigger
                //            HLT_L1Tech_RPC_TTU_RBst1_collisions

                // In 2010 run A, one can find in addition:
                //             
                // 1)         HLT_L1Tech_BSC_minBias
                //            HLT_MinBiasBSC
                //            HLT_MinBiasBSC_NoBPTX
                //            HLT_L1Tech_HCAL_HF
                // 2)         - 
                // 3)         HLT_StoppedHSCP_8E29
                // 4)         HLT_L1Tech_BSC_halo_forPhysicsBackground
                // 5)  multi-vertex triggers, moved to Commissioning dataset in Run B
                //            HLT_MultiVertex6
                //            HLT_MultiVertex8_L1ETT60 
                // 6)  isolated track triggers (frequently fire GoodMuTrigger or GoodElectronTrigger)       
                //            HLT_IsoTrackHB
                //            HLT_IsoTrackHB_8E29
                //            HLT_IsoTrackHE
                //            HLT_IsoTrackHE_8E29

		// There are four categories of triggers in the Commissioning dataset of Run B:
                //
                // 1) ~30% "almost" Minimum-bias-like trigger (some tagger requirements)
                //            HLT_L1_BptxXOR_BscMinBiasOR 
                //
                // 2) ~10% multi-vertex triggers with or without energy threshold (biased)
                //            HLT_MultiVertex6_v2      *** added ***
                //            HLT_MultiVertex6
                //            HLT_MultiVertex8_L1ETT60_v2  *** added ***
                //            HLT_MultiVertex8_L1ETT60
                //
                // 3) ~30% isolated track triggers with some L1 jet (e.g. for taus, exclusive final states?)
                //            HLT_IsoTrackHB_v2
                //            HLT_IsoTrackHB
                //            HLT_IsoTrackHE_v3
                //            HLT_IsoTrackHE_v2
                //            HLT_IsoTrackHE
                //
                // 4) ~20% technical "muon" (DT or CSC based) triggers
                //            HLT_Activity_CSC
                //            HLT_Activity_DT
                //            HLT_Activity_DT_Tuned

                // The ParkingL1MinumumBias dataset (2017) has essentially one trigger:
                //            HLT_L1MinimumBiasHF_OR_part0_v2   

                // The ParkingHIZeroBias dataset (2017) has essentially one trigger:
                //            HLT_HIZeroBias_part3_v6   

                // check ZeroBias, MinBias and Commissioning triggers
                ZeroBiasTrig = false;
                MinimumBiasTrig = false;
                CommissioningTrig = false;
                GoodMinimumBiasTrig = false;
                GoodMuMinimumBiasTrig = false;

                ZeroBiasFlag = -1;
                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check ZeroBias Triggers  --- have all been checked for real occurrence in ZeroBias sample :-)
                    bool ZeroBiasTrigThis = true;

                    // BPTX based
		    if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L1_BPTX_MinusOnly")  {if (ZeroBiasFlag<0) ZeroBiasFlag=0;}
		    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L1_BPTX_PlusOnly") {if (ZeroBiasFlag<0) ZeroBiasFlag=0;}
		    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L1_BPTX")       {if (ZeroBiasFlag<0) ZeroBiasFlag=0;}
                    // actual ZeroBias
		    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_ZeroBias")      {if (ZeroBiasFlag<1) ZeroBiasFlag=1;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_Random")        {if (ZeroBiasFlag<1) ZeroBiasFlag=1;}
                    // 2017 HIZeroBias
		    else if (trigNames.triggerName(i)=="HLT_HIZeroBias_part3_v6")                  {if (ZeroBiasFlag<1) ZeroBiasFlag=1;}
                    else  ZeroBiasTrigThis = false;
              

                    // check and set whether trigger for ZeroBias dataset has fired
                    if (ZeroBiasTrigThis) ZeroBiasTrig = true;


                    // check Minimum Bias triggers    ---  have all been checked for real occurrence in MinimumBias sample :-)
                    //                                    the ones which are commented out without comment have been listed but do not occur
                    //                                    as unique triggers 
                    bool MinimumBiasTrigThis = true;
                    //
                    // Stopped High mass Stable Charged Particles (exotics); don't use if unique.
                    // These triggers ask interactions to be out-of-time, and off-beam, with a veto on BPTX
                    // (the additions 20 and 35 actually indicate jet energy thresholds, not multiplicities) 
                    //    https://twiki.cern.ch/twiki/bin/view/CMS/StoppedHSCP
                    if      (trigNames.triggerName(i)=="HLT_StoppedHSCP35_v3") {if (MinBiasMult<-35) MinBiasMult=-35;}
                    else if (trigNames.triggerName(i)=="HLT_StoppedHSCP20_v3") {if (MinBiasMult<-20) MinBiasMult=-20;}
		    else if (trigNames.triggerName(i)=="HLT_StoppedHSCP_8E29") {if (MinBiasMult<-19) MinBiasMult=-19;}
		    else if (trigNames.triggerName(i)=="HLT_StoppedHSCP_v2")   {if (MinBiasMult<-19) MinBiasMult=-19;}
		    else if (trigNames.triggerName(i)=="HLT_StoppedHSCP")      {if (MinBiasMult<-19) MinBiasMult=-19;}
                    //
                    // with cuts on (in time) ECAL clusters, don't use if unique
		    // else if (trigNames.triggerName(i)=="HLT_L1SingleEG1")                  {if (MinBiasMult<-1) MinBiasMult=-1;}
		    // else if (trigNames.triggerName(i)=="HLT_L1SingleEG1_NoBPTX")           {if (MinBiasMult<-1) MinBiasMult=-1;}
		    // else if (trigNames.triggerName(i)=="HLT_L1SingleEG2_NoBPTX")           {if (MinBiasMult<-2) MinBiasMult=-2;}
		    // else if (trigNames.triggerName(i)=="HLT_L1SingleEG5_NoBPTX")           {if (MinBiasMult<-5) MinBiasMult=-5;}
		    // else if (trigNames.triggerName(i)=="HLT_DoublePhoton5_eeRes_L1R")      {if (MinBiasMult<-5) MinBiasMult=-5;}
		    // else if (trigNames.triggerName(i)=="HLT_EgammaSuperClusterOnly_L1R")   {if (MinBiasMult<-8) MinBiasMult=-8;}
		    // else if (trigNames.triggerName(i)=="HLT_L1SingleEG10_NoBPTX")          {if (MinBiasMult<-10)MinBiasMult=-10;}
                    // not really minimum bias (pt/ET cuts), don't use if unique
		    // else if (trigNames.triggerName(i)=="HLT_MinBiasPixel_DoubleIsoTrack5") {if (MinBiasMult<-25)MinBiasMult=-25;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_MultiVertex8_L1ETT60") {if (MinBiasMult<-60)MinBiasMult=-60;}
		                                       // in Commissioning for Run B
                    // RPC based loose low pt muon trigger, don't use for MinBias if unique, can use as muon trigger (see there)
                    //     https://twiki.cern.ch/twiki/bin/view/CMS/L1TechnicalTriggerBits_RPC
                    else if (trigNames.triggerName(i)=="HLT_L1Tech_RPC_TTU_RBst1_collisions") {
                    // for a general documentation of all L1_tech triggers (and their HLT passthroughs), see 
                    //     https://twiki.cern.ch/twiki/bin/view/CMS/FWDPhysicsExclusiveDijetsAnalysis2011Threshold
                      if (MinBiasMult<-40) MinBiasMult=-40;
                      GoodMuMinimumBiasTrig=true;
                    }
                    //
		    // minimum bias with track multiplicity cut for 2010B data
                    // relevant e.g. for "ridge" studies 
                    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity100") {if (MinBiasMult<0 || MinBiasMult>100)MinBiasMult=100;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity85")  {if (MinBiasMult<0 || MinBiasMult>85) MinBiasMult=85;}
                    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity70")  {if (MinBiasMult<0 || MinBiasMult>70) MinBiasMult=70;}
		    // else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity40")  {if (MinBiasMult<0 || MinBiasMult>40) MinBiasMult=40;}
		    // else if (trigNames.triggerName(i)=="HLT_HighMult40")                  {if (MinBiasMult<0 || MinBiasMult>39) MinBiasMult=39;}
                    // for 2011A data
		    // else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity125_v3")  {if (MinBiasMult<0 || MinBiasMult>125) MinBiasMult=125;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity110_v1") {if (MinBiasMult<0 || MinBiasMult>110) MinBiasMult=110;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity100_v9") {if (MinBiasMult<0 || MinBiasMult>100) MinBiasMult=100;}

		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity100_v7") {if (MinBiasMult<0 || MinBiasMult>100) MinBiasMult=100;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity100_v6") {if (MinBiasMult<0 || MinBiasMult>100) MinBiasMult=100;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v9")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}

		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v7")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v6")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v5")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v4")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v3")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
		    else if (trigNames.triggerName(i)=="HLT_PixelTracks_Multiplicity80_v2")  {if (MinBiasMult<0 || MinBiasMult>80) MinBiasMult=80;}
                    //
                    // minimum bias with cut on 1 or 2 tracks
		    // else if (trigNames.triggerName(i)=="HLT_MinBiasPixel_DoubleTrack") {if (MinBiasMult<0 || MinBiasMult>2) MinBiasMult=2;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_IsoTrackHB")       {if (MinBiasMult<-1) MinBiasMult=-1;} 
                        // on MinimumBias for Run A, in Commissioning for Run B
                    else if (trigNames.triggerName(i)=="HLT_IsoTrackHB_8E29")  {if (MinBiasMult<-1) MinBiasMult=-1;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_IsoTrackHE")       {if (MinBiasMult<-1) MinBiasMult=-1;} 
                        // in Commissioning for Run B
                    else if (trigNames.triggerName(i)=="HLT_IsoTrackHE_8E29")  {if (MinBiasMult<-1) MinBiasMult=-1;} 
                    // else if (trigNames.triggerName(i)=="HLT_MinBiasPixel_SingleTrack") {if (MinBiasMult<0 || MinBiasMult>1) MinBiasMult=1;}
		    // else if (trigNames.triggerName(i)=="HLT_ZeroBiasPixel_SingleTrack"){if (MinBiasMult<0 || MinBiasMult>1) MinBiasMult=1;}
                    // with enhanced pileup, need at least one track per vertex  -> moved to Commissioning 
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_MultiVertex6") {if (MinBiasMult<-6) MinBiasMult=-6;}
                         // The latter occurs for MinimumBias for Run A, and for Commissioning in Run B?

                    //
                    // BSC based
                    // with multiplicity cut
		    else if (trigNames.triggerName(i)=="HLT_L1Tech_BSC_HighMultiplicity"){if (MinBiasMult<0 || MinBiasMult<50) MinBiasMult=50;}
		    // else if (trigNames.triggerName(i)=="HLT_HighMultiplicityBSC")                    MinBiasMult=0;
                    // without track multiplicity cut
		    else if (trigNames.triggerName(i)=="HLT_L1Tech_BSC_minBias")                     MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_L1Tech_BSC_minBias_OR")                  MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_BackwardBSC")                            MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_ForwardBSC")                             MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_L1_BSC")                                 MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_L1_BscMinBiasOR_BeamGas")                MinBiasMult=0;
                    // for Commissioning10 900 GeV
		    else if (trigNames.triggerName(i)=="HLT_L1_BscMinBiasOR_BptxPlusORMinus")        MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_L1_BscMinBiasOR_BptxPlusOrMinus_NoBPTX") MinBiasMult=0;
                    // for 2010 Run A
		    else if (trigNames.triggerName(i)=="HLT_MinBiasBSC")                             MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_MinBiasBSC_NoBPTX")                      MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_MinBiasBSC_OR")                          MinBiasMult=0;
                    // for 2011A data
		    else if (trigNames.triggerName(i)=="HLT_L1Tech_BSC_minBias_threshold1_v1")       MinBiasMult=0;
                    // BPTX based (in both ZeroBias and MinimumBias samples for Run A)
		    //else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L1_BPTX_MinusOnly") MinBiasMult=0;
		    //else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L1_BPTX_PlusOnly")  MinBiasMult=0;
		    //else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L1_BPTX")           MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_L1_BPTX_MinusOnly") MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_L1_BPTX_PlusOnly")  MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_L1_BPTX")           MinBiasMult=0;
                    // HF based (2015 5 TeV MinBias data+MC)
		    else if (trigNames.triggerName(i)=="HLT_L1MinimumBiasHF10R_part2_v1")            MinBiasMult=0;
                    // HF based (2017 13 TeV L1MinBias data)
		    else if (trigNames.triggerName(i)=="HLT_L1MinimumBiasHF_OR_part0_v2")            MinBiasMult=0;
                    // for 2011A data, with jet threshold (not minimum bias)
                    // can/should these be used as jet triggers?
		    else if (trigNames.triggerName(i)=="HLT_JetE50_NoBPTX3BX_NoHalo_v3") {if (MinBiasMult<-50) MinBiasMult=-50;}
		    else if (trigNames.triggerName(i)=="HLT_JetE50_NoBPTX3BX_NoHalo_v2") {if (MinBiasMult<-50) MinBiasMult=-50;}
		    else if (trigNames.triggerName(i)=="HLT_JetE50_NoBPTX3BX_NoHalo_v1") {if (MinBiasMult<-50) MinBiasMult=-50;}
                    // MC 2011
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v11") {if (MinBiasMult<-30) MinBiasMult=-30;}

		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v8") {if (MinBiasMult<-30) MinBiasMult=-30;}
     //		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v7") {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v6") {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v5") {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v4") {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v2") {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX3BX_NoHalo_v1") {if (MinBiasMult<-30) MinBiasMult=-30;}
                    // 2011 MC 
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v11")    {if (MinBiasMult<-30) MinBiasMult=-30;}

		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v8")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v7")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v6")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v5")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v4")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v2")    {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_NoHalo_v1")    {if (MinBiasMult<-30) MinBiasMult=-30;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v9")           {if (MinBiasMult<-30) MinBiasMult=-30;}

		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v6")           {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v5")           {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v4")           {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v3")           {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v2")           {if (MinBiasMult<-30) MinBiasMult=-30;}
		    else if (trigNames.triggerName(i)=="HLT_JetE30_NoBPTX_v1")           {if (MinBiasMult<-30) MinBiasMult=-30;}
                    // what is this?
		    else if (trigNames.triggerName(i)=="HLT_70Jet13_v1")                 {if (MinBiasMult<-70) MinBiasMult=-70;}
		    else if (trigNames.triggerName(i)=="HLT_70Jet10_v1")                 {if (MinBiasMult<-70) MinBiasMult=-70;}
		    else if (trigNames.triggerName(i)=="HLT_60Jet10_v1")                 {if (MinBiasMult<-60) MinBiasMult=-60;}
                    // HF based (2010A)
		    // else if (trigNames.triggerName(i)=="HLT_HFthreshold10")                          MinBiasMult=0;                   
		    // else if (trigNames.triggerName(i)=="HLT_HFthreshold3")                           MinBiasMult=0;                   
		    else if (trigNames.triggerName(i)=="HLT_L1Tech_HCAL_HF")                         MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_L1Tech_HCAL_HF_coincidence_PM")          MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_HFTech")                                 MinBiasMult=0;
                    // CAl based
		    // else if (trigNames.triggerName(i)=="HLT_MinBiasEcal")                            MinBiasMult=0;
		    // else if (trigNames.triggerName(i)=="HLT_MinBiasHcal")                            MinBiasMult=0;
                    // minimum or 0 bias
		    // else if (trigNames.triggerName(i)=="HLT_MinBias")                                MinBiasMult=0;
                    // for the next two, also see 
                    //    https://twiki.cern.ch/twiki/bin/view/CMS/FWDPhysicsExclusiveDijetsAnalysis2011Threshold
                    // in both ZeroBias and MinimumBias dataset for 2010 Run A ??
		    // else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_ZeroBias")           MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias")           MinBiasMult=0;
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_Random")             MinBiasMult=0;
                    // for 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_v5")                            MinBiasMult=0;
                    // for 2011A data
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_v4")                            MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_v3")                            MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_v2")                            MinBiasMult=0;
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_v1")                            MinBiasMult=0;
                    // for 2016 ZeroBias data
		    else if (trigNames.triggerName(i)=="HLT_ZeroBias_FirstCollisionAfterAbortGap_v3")MinBiasMult=0;
                    // ... also 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Random_v1")                              MinBiasMult=0;
                    // for 2011A data, "or" of all L1 trigger seeds, including (mostly single) muons, "L1 passthrough"
                    else if (trigNames.triggerName(i)=="HLT_Physics_v2")                             MinBiasMult=-1;
                    else if (trigNames.triggerName(i)=="HLT_Physics_v1")                             MinBiasMult=-1;
                    // for 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Physics_v3")                             MinBiasMult=-1;
                    //
                    // background triggers
		    else if (trigNames.triggerName(i)=="HLT_L1Tech_BSC_halo_forPhysicsBackground") {if (MinBiasMult<-90) MinBiasMult=-90;}
		    // else if (trigNames.triggerName(i)=="HLT_SplashBSC")                           {if (MinBiasMult<-91) MinBiasMult=-91;}
                    
                    else MinimumBiasTrigThis = false; // none of the above triggered 

                    // check and set whether trigger for MinBias dataset has fired
                    if (MinimumBiasTrigThis) MinimumBiasTrig = true;


                    //check Commissioning triggers
                    bool CommissioningTrigThis = true;

                    // the following trigger on an isolated track associated to an L1 jet, i.e. energy threshold
                    // e.g. Tau candidates, not really minimum bias   *** check overlap with minimum bias ***
                    if      (trigNames.triggerName(i)=="HLT_IsoTrackHB_v2")     {if (MinBiasMult<-1) MinBiasMult=-1;}
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_IsoTrackHB")       {if (MinBiasMult<-1) MinBiasMult=-1;} 
                        // on MinimumBias for Run A, in Commissioning for Run B
                    else if (trigNames.triggerName(i)=="HLT_IsoTrackHE_v3")     {if (MinBiasMult<-1) MinBiasMult=-1;}
                    else if (trigNames.triggerName(i)=="HLT_IsoTrackHE_v2")     {if (MinBiasMult<-1) MinBiasMult=-1;}
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_IsoTrackHE")       {if (MinBiasMult<-1) MinBiasMult=-1;}
                        // on MinimumBias for Run A, in Commissioning for Run B
                    // Ecal based
                    // else if (trigNames.triggerName(i)=="HLT_Activity_Ecal")                          MinBiasMult=0;
                    // else if (trigNames.triggerName(i)=="HLT_Activity_EcalREM")                       MinBiasMult=0;
                    // HCAL based
                    // else if (trigNames.triggerName(i)=="HLT_Activity_L1A")                           MinBiasMult=0;
                    // tracking based
                    // else if (trigNames.triggerName(i)=="HLT_Activity_PixelClusters")                 MinBiasMult=0;
                    // BPTX/BSC based
                    else if (trigNames.triggerName(i)=="HLT_L1_BptxXOR_BscMinBiasOR")                MinBiasMult=0;
                    // Multi-vertex (need at least one track to identify vertex)
                    //               seems to be biasing the track per vertex multiplicity distribution
                    else if (trigNames.triggerName(i)=="HLT_MultiVertex6_v2")                        MinBiasMult=-6;
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_MultiVertex6")    MinBiasMult=-6;
                    // The latter occurs in MinimumBias for Run A, and for Commissioning in Run B?
                    // with ET threshold
                    else if (trigNames.triggerName(i)=="HLT_MultiVertex8_L1ETT60_v2") {if (MinBiasMult<-60) MinBiasMult=-60;}
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_MultiVertex8_L1ETT60")    {if (MinBiasMult<-60) MinBiasMult=-60;}
                    // muon triggers, not for minimum bias
                    else if (trigNames.triggerName(i)=="HLT_Activity_CSC")            {if (MinBiasMult<-41) MinBiasMult=-41;}
                    else if (trigNames.triggerName(i)=="HLT_Activity_DT")             {if (MinBiasMult<-42) MinBiasMult=-42;}
                    else if (trigNames.triggerName(i)=="HLT_Activity_DT_Tuned")       {if (MinBiasMult<-42) MinBiasMult=-42;}

                    else CommissioningTrigThis = false; // none of the above triggered

                    // check and set whether trigger for Commissioning dataset has fired
                    if (CommissioningTrigThis) CommissioningTrig = true;

	          }
                }

	        //h150->Fill(MinBiasMult);		// fill minimum bias trigger histogram


		//  ZeroBias triggers and triggers with multiplicities 
                //  between 0 and 2 are OK
                if (ZeroBiasFlag>-1 || (MinBiasMult > -1 && MinBiasMult < 3)) {
		  GoodMinimumBiasTrig = true;
                  return true;
                }
                else if ((MinimumBiasdataset || Commissioningdataset) && MinBiasMult == -99) {
// activate this for debug  
                  std::cout<<" ****** no MinBias or Commissioning Trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if already known to be Minimum Bias or Commissioning dataset
                  if ((dataset == "MinimumBias" && !MinimumBiasTrig) || (dataset == "Commissioning" && !CommissioningTrig)) exit(1);
#endif
                }
                return false;
}


//*********************************************************************
// ---- method called for each event to check good muon trigger ---- //
//*********************************************************************

bool NanoAnalyzer::providesGoodMuTrigger(const edm::Event& iEvent) {

// *************************************************************
//------------------ get and check trigger info ----------------
// *************************************************************

#ifndef CMSSW7plus
                edm::Handle<edm::TriggerResults> triggerResults;
                edm::Handle<edm::TriggerResults> triggerResultsHandle_;
                edm::InputTag trigResultsTag("TriggerResults","","HLT"); 
                iEvent.getByLabel(trigResultsTag,triggerResultsHandle_);
#endif
#ifdef CMSSW7plus
  //EDGetTokenT<edm::TriggerResults> trigTkn;
  //trigTkn = consumes< edm::TriggerResults>(edm::InputTag("TriggerResults","","HLT"));
  edm::Handle<edm::TriggerResults> triggerResultsHandle_;  
  iEvent.getByToken(trigTkn, triggerResultsHandle_);  
#endif

                // check whether trigger info was obtained successfully
                if (!triggerResultsHandle_.isValid()) {
		  std::cout << "Nano::goodTrigger: Error in getting TriggerResults product from Event!" << std::endl;
                  return false;
                }

                // get trigger names
                const edm::TriggerNames& trigNames = iEvent.triggerNames(*triggerResultsHandle_); 

//                // dump trigger information including accept flag
//                for(unsigned i= 0; i<trigNames.size(); i++) { 
//                  if (triggerResultsHandle_->accept(i)==1){
//                    std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
//                    std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
//      	    }
//                }


                // There are four categories of triggers in the 2010B Mu dataset (with significant overlaps):
                //
                // 1) ~70% inclusive single muon triggers with varying trigger pt threshold 3,5,7,9,11,13,15,17,19,21 GeV
                //    plus a few with loosened quality cuts
                //
                // 2) ~20% isolated single muon triggers with varying trigger pt threshold 9,11,13,15,17 GeV
                //
                // 3) ~10% inclusive dimuon triggers with varying trigger pt threshold 3,5 GeV
                //    plus one Z->mumu trigger with loosened quality cuts
                //
                // 4) ~20% combinations of muon triggers with various pt thresholds 3,5,7,8,9,11 GeV 
                //    with some EM/e/gamma or hadronic/jet energy deposit with thresholds 6-100 GeV 


                // There are two categories of triggers in the MuOnia dataset, which overlaps noticeably with the Mu dataset,
                // even though the trigger selections have no formal overlap:
                //
                // 3) ~30% inclusive dimuon triggers with no explicit trigger pt threshold 
                //    or loosened requirements on 2nd muon
                //
                // 5) ~70% J/psi or quarkonium (dimuon) triggers with no or very loose pt thresholds 
                //    and cuts on dimuon mass in range 1.5-15 GeV

               
                // There are three categories of triggers in the MuMonitoring dataset, which strongly overlaps with the 
                // Mu and MuOnia datasets, including formal overlaps of the trigger selection.
                // These categories are also heavily overlapping with each other.  
                // The dataset provides some additional acceptance for low pt and/or lower quality muons.
                //
                // 1) ~70% inclusive single muon triggers with varying trigger pt threshold 0,3,5,7 GeV
                //    plus several with loosened quality cuts
                //
                // 3) ~50% inclusive dimuon triggers with no explicit trigger pt threshold 
                //    or loosened requirements on 2nd muon
                //
                // 5) ~5% one J/psi trigger with no pt threshold 

 
                // check Muon triggers
                // beware: cannot expect any particular ordering !!!
                MuTrig = false;
                MuHadTrig = false;
                DoubleMuTrig = false;
                MuEGTrig = false;
                MuOniaTrig = false;
                CharmoniumTrig = false;
                MuMonitorTrig = false;
                GoodMuTrig = false;
               
                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check Mu (2010) or SingleMu (2011) triggers
                    // can occur exclusively on Mu sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in Mu sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool MuTrigThis = true;
                    
                    // combined triggers, to be discarded if exclusive, need to allow negative thresholds if want to keep
                    if      (trigNames.triggerName(i)=="HLT_IsoMu9_PFTau15_v2")   {if (IsoMuThresh<-9) IsoMuThresh=-9;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu9_PFTau15_v1")   {if (IsoMuThresh<-9) IsoMuThresh=-9;}
		    // else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT50U")     {if (DoubleMuThresh<-3) DoubleMuThresh=-3;} 
		    else if (trigNames.triggerName(i)=="HLT_L1Mu14_L1ETM30")      {if (MuThresh<-14) MuThresh=-14;}
		    else if (trigNames.triggerName(i)=="HLT_L1Mu14_L1SingleEG10") {if (MuThresh<-14) MuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_L1Mu14_L1SingleJet6U"){if (MuThresh<-14) MuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_HT70U_v1")   {if (MuThresh<-3)  MuThresh=-3;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu5_Photon9_L1R")   {if (MuThresh<-5)  MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu11_PFTau15_v2")     {if (MuThresh<-11) MuThresh=-11;}
                    else if (trigNames.triggerName(i)=="HLT_Mu11_PFTau15_v1")     {if (MuThresh<-11) MuThresh=-11;}
                    else if (trigNames.triggerName(i)=="HLT_Mu11_Ele8_v1")  {if (MuThresh<-11) MuThresh=-11;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele8_v1")   {if (MuThresh<-8)  MuThresh=-8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_Photon13_Cleaned_L1R_v1") {if (MuThresh<-7) MuThresh=-7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Photon11_Cleaned_L1R_v1") {if (MuThresh<-5) MuThresh=-5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_Photon9_Cleaned_L1R")     {if (MuThresh<-5) MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele17_v2")  {if (MuThresh<-5) MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele13_v2")  {if (MuThresh<-5) MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele9_v1")   {if (MuThresh<-5) MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele5_v1")   {if (MuThresh<-5) MuThresh=-5;}
		    // introduce MuHadFlag=1 for Mu+HT, 2 for Mu+Jet
                    // take Mu/HT/jet thresholds from corresponding negative flag
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT100U_v3") {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                      if (MuThresh<-5) MuThresh=-5;
                      if (HTThresh<-100) HTThresh=-100;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT70U_v3")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                      if (MuThresh<-5) MuThresh=-5;
                      if (HTThresh<-70) HTThresh=-70;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT50U_v1")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1; 
                      if (MuThresh<-5) MuThresh=-5;
                      if (HTThresh<-50) HTThresh=-50;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Jet70U_v3") {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                      if (MuThresh<-5) MuThresh=-5;
                      if (JetThresh<-70) JetThresh=-70;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Jet50U_v3") {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                      if (MuThresh<-5) MuThresh=-5;
                      if (JetThresh<-50) JetThresh=-50;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Jet35U_v1") {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                      if (MuThresh<-5) MuThresh=-5;
                      if (JetThresh<-35) JetThresh=-35;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_MET45_v3")  {if (MuThresh<-5) MuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_MET45_v1")  {if (MuThresh<-5) MuThresh=-5;}
                    // inclusive L1 or L2 single muon triggers, to be superseded by L3 if fired, for 2010
                    // MuThresh will be set accordingly below
		    else if (trigNames.triggerName(i)=="HLT_L1Mu30") {if (MuThresh<0) MuThresh=30;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L1Mu20") {if (MuThresh<0) MuThresh=20;}  // in list, but moved to MuMonitor for 2010 Run B
                    else if (trigNames.triggerName(i)=="HLT_L2Mu25") {if (MuL2Thresh<0 || MuL2Thresh>25) MuL2Thresh=25;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu15") {if (MuThresh<0) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu11") {if (MuThresh<0) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu9")  {if (MuL2Thresh<0 || MuL2Thresh>9) MuL2Thresh=9;}
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L2Mu0") {MuL2Thresh=0; MuThresh=1;} // not in list, in Mumonitor for Run B, in both in Run A?
                       // beware, if this is activated also for Run A, distinction between Mu and MuMonitor might become impossible!
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_L1DoubleMuOpen")  DoubleMuThresh=0; // on MuMonitor for Run B (duplicated in both for Run A?)
 
                    // not in competition with HLT
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu20_NoVertex_v1") {if (DoubleMuThresh<0 || DoubleMuThresh>20) DoubleMuThresh=20;}

                    // for 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu20_v5") {if (MuL1Thresh<0 || MuL1Thresh>20) MuL1Thresh=20;}
                    // for 2011
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu20_v4") {if (MuL1Thresh<0 || MuL1Thresh>20) MuL1Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu20_v3") {if (MuL1Thresh<0 || MuL1Thresh>20) MuL1Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu20_v2") {if (MuL1Thresh<0 || MuL1Thresh>20) MuL1Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu20_v1") {if (MuL1Thresh<0 || MuL1Thresh>20) MuL1Thresh=20;} 
                    // 2011 MC 
	            else if (trigNames.triggerName(i)=="HLT_L2Mu20_v7")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}

	            else if (trigNames.triggerName(i)=="HLT_L2Mu20_v6")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu20_v5")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu20_v4")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu20_v3")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;} 
		    else if (trigNames.triggerName(i)=="HLT_L2Mu20_v2")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu20_v1")       {if (MuL2Thresh<0 || MuL2Thresh>20) MuL2Thresh=20;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu10_v5") {if (MuL1Thresh<0 || MuL1Thresh>10) MuL1Thresh=10;}

		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu10_v4") {if (MuL1Thresh<0 || MuL1Thresh>10) MuL1Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu10_v3") {if (MuL1Thresh<0 || MuL1Thresh>10) MuL1Thresh=10;} 
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu10_v2") {if (MuL1Thresh<0 || MuL1Thresh>10) MuL1Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L1SingleMu10_v1") {if (MuL1Thresh<0 || MuL1Thresh>10) MuL1Thresh=10;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v7")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}

		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v6")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v5")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;} 
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v4")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v3")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v2")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}
		    else if (trigNames.triggerName(i)=="HLT_L2Mu10_v1")       {if (MuL2Thresh<0 || MuL2Thresh>10) MuL2Thresh=10;}
		    // inclusive single Mu triggers for 2010
                    else if (trigNames.triggerName(i)=="HLT_Mu30_NoVertex_v1") {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu21_v1") {if (MuThresh<0 || MuThresh>21) MuThresh=21;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_NoVertex")    {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Mu19_v1") {if (MuThresh<0 || MuThresh>19) MuThresh=19;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_v1") {if (MuThresh<0 || MuThresh>17) MuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_v1") {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_v1") {if (MuThresh<0 || MuThresh>13) MuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu11")    {if (MuThresh<0 || MuThresh>11) MuThresh=11;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9")     {if (MuThresh<0 || MuThresh>9)  MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7")     {if (MuThresh<0 || MuThresh>7)  MuThresh=7;} // also in MuMonitor
                    else if (trigNames.triggerName(i)=="HLT_Mu5")     {if (MuThresh<0 || MuThresh>5)  MuThresh=5;} // also in MuMonitor
                    else if (trigNames.triggerName(i)=="HLT_Mu3")     {if (MuThresh<0 || MuThresh>3)  MuThresh=3;} // also in MuMonitor
                    //
                    // for 2011
// MuXXeta2p1, XX = 50,60,100,200 do not occur uniquely in practice 
// (|eta|<2.1)
// The following three do not occur uniquely in practice ... 
//		    else if (trigNames.triggerName(i)=="HLT_Mu100_v5")        {if (MuThresh<0 || MuThresh>100) MuThresh=100;}
//		    else if (trigNames.triggerName(i)=="HLT_Mu100_v3")        {if (MuThresh<0 || MuThresh>100) MuThresh=100;}
//		    else if (trigNames.triggerName(i)=="HLT_Mu60_v2")         {if (MuThresh<0 || MuThresh>60) MuThresh=60;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu40_v11")        {if (MuThresh<0 || MuThresh>40) MuThresh=40;}  
		    else if (trigNames.triggerName(i)=="HLT_Mu40_v6")         {if (MuThresh<0 || MuThresh>40) MuThresh=40;}  
		    else if (trigNames.triggerName(i)=="HLT_Mu40_v5")         {if (MuThresh<0 || MuThresh>40) MuThresh=40;}
		    else if (trigNames.triggerName(i)=="HLT_Mu40_v3")         {if (MuThresh<0 || MuThresh>40) MuThresh=40;}
		    else if (trigNames.triggerName(i)=="HLT_Mu40_v1")         {if (MuThresh<0 || MuThresh>40) MuThresh=40;}
		    else if (trigNames.triggerName(i)=="HLT_Mu40_eta2p1_v1")  {if (MuThresh<-40) MuThresh=-40;}
                    // 2011 MC 
		    else if (trigNames.triggerName(i)=="HLT_Mu40_eta2p1_v6")  {if (MuThresh<-40) MuThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu30_v13")        {if (MuThresh<0 || MuThresh>30) MuThresh=30;}

                    else if (trigNames.triggerName(i)=="HLT_Mu30_v8")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_v7")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_v5")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_v4")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_v3")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_v2")         {if (MuThresh<0 || MuThresh>30) MuThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_eta2p1_v1")  {if (MuThresh<-30) MuThresh=-30;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v8")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}

		    else if (trigNames.triggerName(i)=="HLT_Mu24_v8")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v7")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v5")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v4")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v3")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_v2")         {if (MuThresh<0 || MuThresh>24) MuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_Mu24_eta2p1_v1")  {if (MuThresh<-24) MuThresh=-24;}
                    // 2011 MC 
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v13")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}

		    else if (trigNames.triggerName(i)=="HLT_Mu20_v8")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v7")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v6")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v5")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v4")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v3")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v2")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_Mu20_v1")         {if (MuThresh<0 || MuThresh>20) MuThresh=20;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v14")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}

		    else if (trigNames.triggerName(i)=="HLT_Mu15_v9")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v8")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v6")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v5")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v4")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v3")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_v2")         {if (MuThresh<0 || MuThresh>15) MuThresh=15;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v8")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}

		    else if (trigNames.triggerName(i)=="HLT_Mu12_v8")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v7")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v5")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v3")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v4")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v2")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_Mu12_v1")         {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v13")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}

		    else if (trigNames.triggerName(i)=="HLT_Mu8_v8")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v7")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v5")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v4")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v3")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v2")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
		    else if (trigNames.triggerName(i)=="HLT_Mu8_v1")          {if (MuThresh<0 || MuThresh>8)  MuThresh=8;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v15")         {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}

		    else if (trigNames.triggerName(i)=="HLT_Mu5_v10")         {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v9")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v7")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v6")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v5")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v4")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu5_v3")          {if (MuThresh<0 || MuThresh>5)  MuThresh=5;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v9")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v7")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v6")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v5")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v4")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    else if (trigNames.triggerName(i)=="HLT_Mu3_v3")          {if (MuThresh<0 || MuThresh>3)  MuThresh=3;}
		    
                    // inclusive IsoMu triggers for 2010
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v3") {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v3") {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu13_v4") {if (IsoMuThresh<0 || IsoMuThresh>13) IsoMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu13_v3") {if (IsoMuThresh<0 || IsoMuThresh>13) IsoMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu11_v4") {if (IsoMuThresh<0 || IsoMuThresh>11) IsoMuThresh=11;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu11_v3") {if (IsoMuThresh<0 || IsoMuThresh>11) IsoMuThresh=11;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu9_v4")  {if (IsoMuThresh<0 || IsoMuThresh>9)  IsoMuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu9_v3")  {if (IsoMuThresh<0 || IsoMuThresh>9)  IsoMuThresh=9;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu9")     {if (IsoMuThresh<0 || IsoMuThresh>9)  IsoMuThresh=9;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu3")     {if (IsoMuThresh<0 || IsoMuThresh>3) IsoMuThresh=3;}

                    // for 2011
                    // IsoMuXXeta2p1, XX = 24, 30, 34, 40 do not occur uniquely in practice 
                    //    (|eta|<2.1)
		    else if (trigNames.triggerName(i)=="HLT_IsoMu30_v7")         {if (IsoMuThresh<0 || IsoMuThresh>30) IsoMuThresh=30;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v14")        {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}

		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v8")         {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v7")         {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v6")         {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v5")         {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu24_v4")         {if (IsoMuThresh<0 || IsoMuThresh>24) IsoMuThresh=24;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_IsoMu20_v14")        {if (IsoMuThresh<0 || IsoMuThresh>20) IsoMuThresh=20;}

                    else if (trigNames.triggerName(i)=="HLT_IsoMu20_v9")         {if (IsoMuThresh<0 || IsoMuThresh>20) IsoMuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu20_v8")         {if (IsoMuThresh<0 || IsoMuThresh>20) IsoMuThresh=20;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu20_eta2p1_v1")  {if (IsoMuThresh<-20) IsoMuThresh=-20;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v17")        {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v14")        {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v13")        {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v11")        {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v10")        {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v9")         {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v8")         {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v7")         {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_v6")         {if (IsoMuThresh<0 || IsoMuThresh>17) IsoMuThresh=17;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu17_eta2p1_v1")  {if (IsoMuThresh<-17) IsoMuThresh=-17;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v19")        {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}

                    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v14")        {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v13")        {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v11")        {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v10")        {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v9")         {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v8")         {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_v6")         {if (IsoMuThresh<0 || IsoMuThresh>15) IsoMuThresh=15;}
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_eta2p1_v1")  {if (IsoMuThresh<-15) IsoMuThresh=-15;}

		    else if (trigNames.triggerName(i)=="HLT_IsoMu15_eta2p1_v1")  {if (IsoMuThresh<-15) IsoMuThresh=-15;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v9")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v7")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v6")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v5")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v4")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v2")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    else if (trigNames.triggerName(i)=="HLT_IsoMu12_v1")         {if (IsoMuThresh<0 || IsoMuThresh>12) IsoMuThresh=12;}
		    // inclusive dimuon triggers 2010
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_v1") {if (DoubleMuThresh<0||DoubleMuThresh>5) DoubleMuThresh=5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v2") {if (DoubleMuThresh<0||DoubleMuThresh>3) DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3")    {if (DoubleMuThresh<0||DoubleMuThresh>3) DoubleMuThresh=3;}
                    // give some special treatment to this trigger, since it introduces a mass bias?
                    else if (iEvent.run()<145000 && trigNames.triggerName(i)=="HLT_Mu0_Track0_Jpsi") JpsiThresh=0;
                        // moved from Mu -> MuMonitor run A -> B

		    else MuTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for Mu dataset has fired
                    if (MuTrigThis) MuTrig = true; 

                    // If want to use Mu sample only, should quit here. //
                    // If want to merge Mu and MuOnia samples, quit here if MuOnia and already accepted by Mu, and continue if Mu
                    // (might still find lower trigger threshold).  
                    // If want to use MuOnia sample only, should skip the above and start here. 



                    // MuHad triggers for 2011
                    // can occur exclusively on MuHad sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in MuHad sample :-)
                    bool MuHadTrigThis = true;

                    // Mu + HT
                         if (trigNames.triggerName(i)=="HLT_HT300_Mu5_PFMHT40_v8")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-300) HTThresh=-300;}
                    else if (trigNames.triggerName(i)=="HLT_HT300_Mu5_PFMHT40_v7")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-300) HTThresh=-300;}
                    else if (trigNames.triggerName(i)=="HLT_HT300_Mu5_PFMHT40_v5")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-300) HTThresh=-300;}
                    else if (trigNames.triggerName(i)=="HLT_HT300_Mu5_PFMHT40_v3")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-300) HTThresh=-300;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT40_v4")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT20_v7")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT20_v5")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT20_v4")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT20_v3")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu15_PFMHT20_v2")  {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-250) HTThresh=-250;}
		    else if (trigNames.triggerName(i)=="HLT_Mu40_HT200_v4")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-40) MuThresh=-40;
                         if (HTThresh<-200) HTThresh=-200;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_HT200_v3")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-30) MuThresh=-30;
                         if (HTThresh<-200) HTThresh=-200;}
		    else if (trigNames.triggerName(i)=="HLT_Mu30_HT200_v1")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-30) MuThresh=-30;
                         if (HTThresh<-200) HTThresh=-200;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_HT200_v4")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-200) HTThresh=-200;}
		    else if (trigNames.triggerName(i)=="HLT_Mu15_HT200_v3")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_HT200_v2")          {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-15) MuThresh=-15;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_HT200_v4")           {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-8) MuThresh=-8;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT200_v5")           {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT200_v4")           {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_HT200_v3")           {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-200) HTThresh=-200;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu5_PFMHT35_v6")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu5_PFMHT35_v5")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT250_Mu5_PFMHT35_v4")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-250) HTThresh=-250;}
                    else if (trigNames.triggerName(i)=="HLT_HT200_Mu5_PFMHT35_v2")   {if (MuHadFlag<0 || MuHadFlag>1) MuHadFlag=1;
                         if (MuThresh<-5) MuThresh=-5;
                         if (HTThresh<-200) HTThresh=-200;}
         	    // Mu + Jet
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v10")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v8")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v7")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v6")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v5")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v4")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v2")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_v1")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_eta2p1_CentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-17) MuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    // Mu + Dijet 
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v10") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v8") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v7") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v6") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v5") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v4") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_DiCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_eta2p1_DiCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-17) MuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DiJet30_v1") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-5) MuThresh=-5;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_DiJet30_v6") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-3) MuThresh=-3;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_DiJet30_v4") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-3) MuThresh=-3;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_DiJet30_v3") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-3) MuThresh=-3;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_DiJet30_v2") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-3) MuThresh=-3;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_DiJet30_v1") {if (MuHadFlag<0 || MuHadFlag>3) MuHadFlag=3;
                         if (MuThresh<-3) MuThresh=-3;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
		    // DiMu + HT 
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_HT150_v1")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-5) DoubleMuThresh=-5;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT160_v3")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-160) HTThresh=-160;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT160_v2")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-160) HTThresh=-160;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v7")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v5")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v4")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v3")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v2")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_HT150_v1")     {if (MuHadFlag<0 || MuHadFlag>4) MuHadFlag=4;
                         if (DoubleMuThresh<-3) DoubleMuThresh=-3;
                         if (HTThresh<-150) HTThresh=-150;}
		    // Mu + Jet + BTag
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet40_BTagIP_v2")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-40) BThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v9")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v7")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v6")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v5")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v2")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_CentralJet30_BTagIP_v1")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_eta2p1_CentralJet30_BTagIP_v1") {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_CentralJet30_BTagIP_v4")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_CentralJet30_BTagIP_v2")  {if (MuHadFlag<0 || MuHadFlag>5) MuHadFlag=5;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
		    // IsoMu + Jet 
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_v5")      {if (MuHadFlag<0 || MuHadFlag>6) MuHadFlag=6;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_v3")      {if (MuHadFlag<0 || MuHadFlag>6) MuHadFlag=6;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_v2")      {if (MuHadFlag<0 || MuHadFlag>6) MuHadFlag=6;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_v1")      {if (MuHadFlag<0 || MuHadFlag>6) MuHadFlag=6;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_eta2p1_CentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>6) MuHadFlag=6;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (JetThresh<-30) JetThresh=-30;}
		    // IsoMu + Dijet 
                    else if (trigNames.triggerName(i)=="HLT_IsoMu20_DiCentralJet34_v3")    {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-20) IsoMuThresh=-20;
                         if (DiJetThresh<-34) DiJetThresh=-34;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_DiCentralJet30_v5")    {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_DiCentralJet30_v3")    {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_DiCentralJet30_v2")    {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_DiCentralJet30_v1")    {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_eta2p1_DiCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>7) MuHadFlag=7;
                         if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (DiJetThresh<-30) DiJetThresh=-30;}
		    // Mu + Trijet
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v10")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v8")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v7")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v6")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v5")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v4")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v2")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TriCentralJet30_v1")      {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_eta2p1_TriCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_TriJet30_v1")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-5) MuThresh=-5;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_TriJet30_v6")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_TriJet30_v4")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_TriJet30_v3")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_TriJet30_v2")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_TriJet30_v1")              {if (MuHadFlag<0 || MuHadFlag>8) MuHadFlag=8;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
		    // Mu + Dijet + BTag
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet30_BTagIP3D_v5")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet30_BTagIP3D_v3")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet30_BTagIP3D_v2")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet30_BTagIP3D_v1")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_eta2p1_DiCentralJet30_BTagIP3D_v1")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet20_BTagIP3D1stTrack_v2")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-20) BThresh=-20;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet20_DiBTagIP3D1stTrack_v3")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-20) BThresh=-20;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_DiCentralJet20_DiBTagIP3D1stTrack_v1")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-20) BThresh=-20;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_eta2p1_DiCentralJet20_BTagIP3D1stTrack_v1")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-20) BThresh=-20;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_eta2p1_DiCentralJet20_DiBTagIP3D1stTrack_v1")  {if (MuHadFlag<0 || MuHadFlag>9) MuHadFlag=9;
          		 if (MuThresh<-12) MuThresh=-12;
                         if (BThresh<-20) BThresh=-20;}
		    // IsoMu + trijet
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_TriCentralJet30_v2")   {if (MuHadFlag<0 || MuHadFlag>10) MuHadFlag=10;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_TriCentralJet30_v1")   {if (MuHadFlag<0 || MuHadFlag>10) MuHadFlag=10;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_eta2p1_TriCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>10) MuHadFlag=10;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (TriJetThresh<-30) TriJetThresh=-30;}
		    // IsoMu + Jet + BTag
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_BTagIP_v9")  {if (MuHadFlag<0 || MuHadFlag>11) MuHadFlag=11;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_BTagIP_v7")  {if (MuHadFlag<0 || MuHadFlag>11) MuHadFlag=11;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_BTagIP_v6")  {if (MuHadFlag<0 || MuHadFlag>11) MuHadFlag=11;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_CentralJet30_BTagIP_v5")  {if (MuHadFlag<0 || MuHadFlag>11) MuHadFlag=11;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_IsoMu17_eta2p1_CentralJet30_BTagIP_v1")  {if (MuHadFlag<0 || MuHadFlag>11) MuHadFlag=11;
          		 if (IsoMuThresh<-17) IsoMuThresh=-17;
                         if (BThresh<-30) BThresh=-30;}
		    // Mu + Quadjet
                    else if (trigNames.triggerName(i)=="HLT_Mu17_QuadCentralJet30_v5")     {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_QuadCentralJet30_v3")     {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_QuadCentralJet30_v2")     {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_QuadCentralJet30_v1")     {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_eta2p1_QuadCentralJet30_v1") {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-17) MuThresh=-17;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_QuadJet30_v1")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-5) MuThresh=-5;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_QuadJet30_v6")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_QuadJet30_v4")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_QuadJet30_v3")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_QuadJet30_v2")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_QuadJet30_v1")             {if (MuHadFlag<0 || MuHadFlag>12) MuHadFlag=12;
          		 if (MuThresh<-3) MuThresh=-3;
                         if (QuadJetThresh<-30) QuadJetThresh=-30;}
		    // Mu+e+HT (don't use)
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_TrkIdVL_HT150_v1")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdL_TrkIdVL_HT160_v3")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdL_TrkIdVL_HT160_v2")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdL_TrkIdVL_HT150_v3")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdL_TrkIdVL_HT150_v2")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdL_TrkIdVL_HT150_v1")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdT_TrkIdVL_HT150_v6")  {if (MuHadFlag<-1) MuHadFlag=-1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdT_TrkIdVL_HT150_v4")  {if (MuHadFlag<-1) MuHadFlag=-1;}
		    // what is this?
                    else if (trigNames.triggerName(i)=="HLT_Mu10_R025_MR200_v1")                 {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10_R005_MR200_v1")                 {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R025_MR200_v7")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R025_MR200_v5")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R025_MR200_v3")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R020_MR200_v4")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R020_MR200_v3")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R020_MR200_v1")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R005_MR200_v7")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R005_MR200_v5")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R005_MR200_v4")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R005_MR200_v3")                  {if (MuHadFlag<-5) MuHadFlag=-5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_R005_MR200_v1")                  {if (MuHadFlag<-5) MuHadFlag=-5;}

                    else MuHadTrigThis = false;

                    // check and set whether trigger for MuHad dataset has fired
                    if (MuHadTrigThis) MuHadTrig = true; 
 


                    // DoubleMu triggers for 2011 and 2012
                    // can occur exclusively on DoubleMu sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in DoubleMu sample :-)
                    bool DoubleMuTrigThis = true;

                    //
                    // inclusive L2 and L1 dimuon triggers 2011 (thresholds intrinsically differ from HLT ones) 
                    if      (trigNames.triggerName(i)=="HLT_L2DoubleMu35_NoVertex_v1") {if (DoubleMuThresh<0 || DoubleMuThresh>35) DoubleMuThresh=35;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu30_NoVertex_v5") {if (DoubleMuThresh<0 || DoubleMuThresh>30) DoubleMuThresh=30;}

                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu30_NoVertex_v3") {if (DoubleMuThresh<0 || DoubleMuThresh>30) DoubleMuThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu30_NoVertex_v1") {if (DoubleMuThresh<0 || DoubleMuThresh>30) DoubleMuThresh=30;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v7") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}

                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v7") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v5") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v4") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v3") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v2") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v1") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v8")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}

                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v7")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v6")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v5")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v4")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v3")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0_v2")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_L1DoubleMu0_v5")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}

                    else if (trigNames.triggerName(i)=="HLT_L1DoubleMu0_v4")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L1DoubleMu0_v3")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L1DoubleMu0_v2")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    else if (trigNames.triggerName(i)=="HLT_L1DoubleMu0_v1")           {if (DoubleMuThresh<0 || DoubleMuThresh>0)  DoubleMuThresh=0;}
                    // inclusive L2 and L1 dimuon triggers 2012
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v10") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_v11") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_2Cha_Angle2p5_v2") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu23_NoVertex_2Cha_Angle2p5_v3") {if (DoubleMuThresh<0 || DoubleMuThresh>23) DoubleMuThresh=23;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v11")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
                    // inclusive dimuon triggers 2011
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v6")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v5")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v3")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v2")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu45_v1")               {if (DoubleMuThresh<0||DoubleMuThresh>45) DoubleMuThresh=45;}
		    // the next three might not be needed
                    // else if (trigNames.triggerName(i)=="HLT_Mu17_Mu8_v6")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu17_Mu8_v4")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu17_Mu8_v3")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v12")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}

                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v7")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v6")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v4")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v3")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v2")                 {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v13")               {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}

                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v8")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v7")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v5")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v4")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v3")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v2")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu7_v1")                {if (DoubleMuThresh<0||DoubleMuThresh>7)  DoubleMuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v8")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v7")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v5")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v4")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v3")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v2")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_v1")                {if (DoubleMuThresh<0||DoubleMuThresh>6)  DoubleMuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu6_Acoplanarity03_v1") {if (DoubleMuThresh<-16)  DoubleMuThresh=-16;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_v6")                {if (DoubleMuThresh<0||DoubleMuThresh>5)  DoubleMuThresh=5;}

                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_v1")                {if (DoubleMuThresh<0||DoubleMuThresh>5)  DoubleMuThresh=5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Acoplanarity03_v6") {if (DoubleMuThresh<-15)  DoubleMuThresh=-15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Acoplanarity03_v5") {if (DoubleMuThresh<-15)  DoubleMuThresh=-15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Acoplanarity03_v3") {if (DoubleMuThresh<-15)  DoubleMuThresh=-15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Acoplanarity03_v2") {if (DoubleMuThresh<-15)  DoubleMuThresh=-15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Acoplanarity03_v1") {if (DoubleMuThresh<-15)  DoubleMuThresh=-15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v8") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v6") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v5") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v4") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v3") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v2") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu4_Acoplanarity03_v1") {if (DoubleMuThresh<-14)  DoubleMuThresh=-14;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v15")               {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
           
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v10")               {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v9")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v7")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v6")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v5")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v4")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu3_v3")                {if (DoubleMuThresh<0||DoubleMuThresh>3)  DoubleMuThresh=3;}
                    // inclusive dimuon triggers 2012
                    else if (trigNames.triggerName(i)=="HLT_Mu22_TkMu8_v5")               {if (DoubleMuThresh<0||DoubleMuThresh>22) DoubleMuThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Mu22_TkMu8_v6")               {if (DoubleMuThresh<0||DoubleMuThresh>22) DoubleMuThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Mu22_TkMu8_v7")               {if (DoubleMuThresh<0||DoubleMuThresh>22) DoubleMuThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Mu22_TkMu8_v8")               {if (DoubleMuThresh<0||DoubleMuThresh>22) DoubleMuThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TkMu8_v10")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TkMu8_v11")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TkMu8_v12")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_TkMu8_v13")              {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Mu8_v17")                {if (DoubleMuThresh<0||DoubleMuThresh>17) DoubleMuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v17")                {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v18")                {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v19")                {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_Mu13_Mu8_v21")                {if (DoubleMuThresh<0||DoubleMuThresh>13) DoubleMuThresh=13;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu11_Acoplanarity03_v3") {if (DoubleMuThresh<-21)  DoubleMuThresh=-21;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu11_Acoplanarity03_v4") {if (DoubleMuThresh<-21)  DoubleMuThresh=-21;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu11_Acoplanarity03_v5") {if (DoubleMuThresh<-21)  DoubleMuThresh=-21;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v14")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    // inclusive trimuon triggers 2011
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v9")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v8")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v6")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v5")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v4")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v3")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v2")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    // inclusive trimuon triggers 2012
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v17")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v18")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_TripleMu5_v19")                {if (DoubleMuThresh<-5) DoubleMuThresh=-5;}
                    // Mu-Jet triggers 2011 (on DoubleMu dataset)
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v10")   {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v9")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v7")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;} 
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v6")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v5")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v4")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;} 
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v3")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}  
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Jet40_v2")    {if (MuHadFlag<0 || MuHadFlag>2) MuHadFlag=2;
                         if (MuThresh<-8) MuThresh=-8;
                         if (JetThresh<-40) JetThresh=-40;}
                    // Inclusive Mu triggers 2012 (on DoubleMu dataset)
                    else if (trigNames.triggerName(i)=="HLT_Mu17_v3")   {if (MuThresh<0 || MuThresh>17) MuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_v4")   {if (MuThresh<0 || MuThresh>17) MuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_v5")   {if (MuThresh<0 || MuThresh>17) MuThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_v16")   {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_v17")   {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_v18")   {if (MuThresh<0 || MuThresh>8) MuThresh=8;}

                    else DoubleMuTrigThis = false;

                    // check and set whether trigger for DoubleMu dataset has fired
                    if (DoubleMuTrigThis) DoubleMuTrig = true; 
 


                    // MuEG triggers for 2011
                    // can occur exclusively on MuEG sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in MuEG sample :-)
                    bool MuEGTrigThis = true;

                    //
		    // introduce MuEGFlag=1 for Mu+Photon, 2 for Mu+Electron, 3 for DiMu+Electron, 4 for Mu+DiElectron, 
                    //                    5 for Mu+Diphoton, 
                    // inclusive muon+electron triggers 
                    if      (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v1")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v2")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v3")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v4")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v5")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v6")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v8")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v9")           {if (MuEGFlag<1) MuEGFlag=2;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdL_v14")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdT_CaloIsoVL_v9") {if (MuEGFlag<1) MuEGFlag=2;}

                    else if (trigNames.triggerName(i)=="HLT_Mu17_Ele8_CaloIdT_CaloIsoVL_v1") {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10_Ele10_CaloIdL_v2")          {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10_Ele10_CaloIdL_v3")          {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10_Ele10_CaloIdL_v4")          {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v1")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v2")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v3")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v4")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v5")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v6")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v8")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdL_v9")           {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdT_CaloIsoVL_v1") {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdT_CaloIsoVL_v3") {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Ele17_CaloIdT_CaloIsoVL_v4") {if (MuEGFlag<1) MuEGFlag=2;}
                    // really? MuHad?
//                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_TrkIdVL_HT150_v1") {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_CaloIsoVL_v1")  {if (MuEGFlag<1) MuEGFlag=2;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Ele8_CaloIdT_CaloIsoVL_v2")  {if (MuEGFlag<1) MuEGFlag=2;}
                    // inclusive muon+photon triggers
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v2")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v3")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v4")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v5")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v6")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v7")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v9")      {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_Photon20_CaloIdL_v10")     {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v2") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v3") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v4") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v5") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v6") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v8") {if (MuEGFlag<1) MuEGFlag=1;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_Photon20_CaloIdVT_IsoT_v9") {if (MuEGFlag<1) MuEGFlag=1;}
                    // inclusive dimuon+electron triggers
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_v2")                 {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_v3")                 {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_v4")                 {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_v5")                 {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_v6")                 {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_CaloIdL_TrkIdVL_v7") {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_CaloIdL_TrkIdVL_v9") {if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_CaloIdL_TrkIdVL_v10"){if (MuEGFlag<1) MuEGFlag=3;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu5_Ele8_CaloIdT_TrkIdVL_v4") {if (MuEGFlag<1) MuEGFlag=3;}
                    // inclusive muon+dielectron triggers
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_v2")                 {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_v3")                 {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_v4")                 {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_CaloIdL_TrkIdVL_v2") {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_CaloIdT_TrkIdVL_v1") {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_CaloIdT_TrkIdVL_v3") {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_DoubleEle8_CaloIdT_TrkIdVL_v4") {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdL_TrkIdVL_Ele8_v4")  {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdL_TrkIdVL_Ele8_v5")  {if (MuEGFlag<1) MuEGFlag=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_TrkIdVL_Ele8_CaloIdL_TrkIdVL_v1") {if (MuEGFlag<1) MuEGFlag=4;}                    
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_TrkIdVL_Ele8_CaloIdL_TrkIdVL_v3") {if (MuEGFlag<1) MuEGFlag=4;}                    
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Ele8_CaloIdT_TrkIdVL_Ele8_CaloIdL_TrkIdVL_v4") {if (MuEGFlag<1) MuEGFlag=4;}
                    // inclusive muon+diphoton triggers
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v2")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v3")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v4")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v5")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v6")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v7")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v9")  {if (MuEGFlag<1) MuEGFlag=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu15_DoublePhoton15_CaloIdL_v10") {if (MuEGFlag<1) MuEGFlag=5;}
                    
                    else MuEGTrigThis = false;

                    // check and set whether trigger for DoubleMu dataset has fired
                    if (MuEGTrigThis) MuEGTrig = true; 
 



                    // MuOnia triggers
                    // can occur exclusively on MuOnia sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in MuOnia sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool MuOniaTrigThis = true;

                    //  
                    // inclusive Mu+L2 dimuon triggers
		    if      (trigNames.triggerName(i)=="HLT_Mu5_L2Mu0") {if (DoubleMuThresh<0 || DoubleMuThresh>6) DoubleMuThresh=6;} 
		    // else if (trigNames.triggerName(i)=="HLT_Mu3_L2Mu0") {if (DoubleMuThresh<0 || DoubleMuThresh>3) DoubleMuThresh=3;}
                    // inclusive low threshold dimuon triggers 
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu0")            DoubleMuThresh=1;   // also in MuMonitor
                    // else if (trigNames.triggerName(i)=="HLT_L1DoubleMuOpen_Tight") DoubleMuThresh=0;
                    // else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0")          DoubleMuThresh=0;  // in list, but moved to Mumonitor for Run B
                    // the following have a restricted mass (and pt/eta?) range 
                    // else if (trigNames.triggerName(i)=="HLT_Mu5_TkMu0_Jpsi")         {if (JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu5_TkMu0_Jpsi_NoCharge"){if (JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu5_TkMu0_OST_Jpsi")     {if (JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu5_TkMu0_OST_Jpsi_Tight"){if(JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Track0_Jpsi_v2")     {if (JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5_Track0_Jpsi")        {if (JpsiThresh<0 || JpsiThresh>5) JpsiThresh=5;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu3_TkMu0_Jpsi")         {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu3_TkMu0_Jpsi_NoCharge"){if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu3_TkMu0_OST_Jpsi")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu3_TkMu0_OST_Jpsi_Tight"){if(JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track5_Jpsi_v3")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track5_Jpsi_v2")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track5_Jpsi_v1")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track3_Jpsi_v3")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track3_Jpsi_v2")     {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_Track3_Jpsi")        {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu3_Track0_Jpsi")        {if (JpsiThresh<0 || JpsiThresh>3) JpsiThresh=3;}
                    // else if (trigNames.triggerName(i)=="HLT_Mu0_TkMu0_Jpsi")              JpsiThresh=0;
                    // else if (trigNames.triggerName(i)=="HLT_Mu0_TkMu0_Jpsi_NoCharge")     JpsiThresh=0;   
                    else if (trigNames.triggerName(i)=="HLT_Mu0_TkMu0_OST_Jpsi")          JpsiThresh=0;  
                    else if (trigNames.triggerName(i)=="HLT_Mu0_TkMu0_OST_Jpsi_Tight_v3") JpsiThresh=0;
                    else if (trigNames.triggerName(i)=="HLT_Mu0_TkMu0_OST_Jpsi_Tight_v2") JpsiThresh=0;
                    // the following seem to select events in the mass range 1.5-20 GeV
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu0_Quarkonium_v1")     JpsiThresh=0;      
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu0_Quarkonium_LS_v1")  JpsiThresh=0;
                    else MuOniaTrigThis = false; // none of the above fired

                    // check and set whether trigger for MuOnia dataset has fired
		    if (MuOniaTrigThis) MuOniaTrig = true;

                    // If want to use MuOnia sample or Mu+MuOnia sample only, should quit here. 
                    // If want to merge MuOnia or Mu and MuOnia samples with MuMonitor sample, quit here if MuMonitor and already accepted by Mu or MuOnia 
                    // and continue if Mu or MuOnia (might still find lower trigger threshold).  
                    // If want to use MuMonitor only, should skip all of the above and add HLT_Mu3 (overlap with Mu). 



                    // MuMonitor triggers
                    // should only occur exclusively when running over the MuMonitor sample, can occur non-exlusively on all samples
                    //          --  have all been checked for real occurrence in MuMonitor sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool MuMonitorTrigThis = true;
                    //
                    // inclusive L1 or L2 mu triggers,
                    if      (trigNames.triggerName(i)=="HLT_L2Mu30_v1"){if (MuL2Thresh<0||MuL2Thresh>30)MuL2Thresh=30;}
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L1Mu20")   {if (MuL1Thresh<0||MuL1Thresh>20)MuL1Thresh=20;} // not in list, moved from Mu for Run B 
                    else if (trigNames.triggerName(i)=="HLT_L1Mu7_v1") {if (MuL1Thresh<0||MuL1Thresh>7) MuL1Thresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_L2Mu7_v1") {if (MuL2Thresh<0||MuL2Thresh>7) MuL2Thresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7")      {if (MuThresh<0||MuThresh>7) MuThresh=7;} // not in list, duplicating Mu
                    // else if (trigNames.triggerName(i)=="HLT_L2Mu5")    {if (MuThresh<0||MuThresh>5) MuThresh=6;}
                    else if (trigNames.triggerName(i)=="HLT_Mu5")      {if (MuThresh<0||MuThresh>5) MuThresh=5;} // not in list, duplicating Mu
                    else if (trigNames.triggerName(i)=="HLT_L2Mu3")    {if (MuL2Thresh<0||MuL2Thresh>3) MuL2Thresh=3;}
                    else if (trigNames.triggerName(i)=="HLT_Mu3_v2")   {if (MuThresh<0||MuThresh>3) MuThresh=3;} // only in MuMonitor?
                    else if (trigNames.triggerName(i)=="HLT_Mu3")      {if (MuThresh<0||MuThresh>3) MuThresh=3;} // in both Mu and MuMonitor list
                    else if (trigNames.triggerName(i)=="HLT_Mu0_v2")          MuThresh=1;   
                    else if (trigNames.triggerName(i)=="HLT_L1Mu")           {MuL1Thresh=0; MuThresh=1;} // 0 is reserved for minimum bias 
                    else if (trigNames.triggerName(i)=="HLT_L1MuOpen_v2")    {MuL1Thresh=0; MuThresh=1;}       
                    else if (trigNames.triggerName(i)=="HLT_L1MuOpen")       {MuL1Thresh=0; MuThresh=1;}       
                    else if (trigNames.triggerName(i)=="HLT_L1MuOpen_DT_v2") {MuL1Thresh=0; MuThresh=1;}   
                    else if (trigNames.triggerName(i)=="HLT_L1MuOpen_DT")    {MuL1Thresh=0; MuThresh=1;}   
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L2Mu0") {MuL2Thresh=0; MuThresh=1;} // on Mu for Run A 
                    else if (trigNames.triggerName(i)=="HLT_Mu3_L1MuOpen") {if (DoubleMuThresh<0||DoubleMuThresh>4) DoubleMuThresh=4;}
                    else if (trigNames.triggerName(i)=="HLT_Mu0_L1MuOpen")    DoubleMuThresh=0;  
                    // else if (trigNames.triggerName(i)=="HLT_Mu0_L2Mu0")       DoubleMuThresh=0;     
                    else if (trigNames.triggerName(i)=="HLT_L2DoubleMu0")     DoubleMuThresh=0; // not in list,  moved from MuOnia   
                    else if (trigNames.triggerName(i)=="HLT_DoubleMu0")       DoubleMuThresh=0; // not in list,  duplicating MuOnia   
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_L1DoubleMuOpen")  DoubleMuThresh=0; // on Mu for Run A
                    // give some special treatment to this trigger, since it introduces a mass bias?
                    else if (iEvent.run()>145000 && trigNames.triggerName(i)=="HLT_Mu0_Track0_Jpsi") JpsiThresh=0;
                        // moved from Mu -> MuMonitor run A -> B

                    else MuMonitorTrigThis = false; // none of the above fired

                    // check and set whether trigger for MuMonitor dataset has fired
                    if (MuMonitorTrigThis) MuMonitorTrig = true;
		    //		    std::cout<<MuTrigThis<<MuTrig<<MuOniaTrigThis<<MuOniaTrig<<MuMonitorTrigThis<<MuMonitorTrig<<std::endl;

                    // additional muon trigger from MinimumBias dataset, not used for muon dataset ID 
                    // RPC based loose low pt muon trigger
                    //     https://twiki.cern.ch/twiki/bin/view/CMS/L1TechnicalTriggerBits_RPC
                    if (trigNames.triggerName(i)=="HLT_L1Tech_RPC_TTU_RBst1_collisions") {if (MuL1Thresh<0) MuL1Thresh=0;}

                    // additional muon triggers from Commissioning dataset, not used for muon dataset ID
                    if (trigNames.triggerName(i)=="HLT_Activity_CSC")                    {if (MuL1Thresh<0) MuL1Thresh=0;}
                    if (trigNames.triggerName(i)=="HLT_Activity_DT")                     {if (MuL1Thresh<0) MuL1Thresh=0;}
                    if (trigNames.triggerName(i)=="HLT_Activity_DT_Tuned")               {if (MuL1Thresh<0) MuL1Thresh=0;}
        
	          }
                }

                // B Parking triggers: displaced muons
                BParkingTrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check B Parking triggers
                    // can occur exclusively on 2018 ParkingB sample only, but can also occur on other samples if non-exclusive
                    bool BParkTrigThis = true;

                    // displaced muon triggers
                    if      (trigNames.triggerName(i)=="HLT_Mu12_IP6_part0_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}  // Run B
                    else if (trigNames.triggerName(i)=="HLT_Mu12_IP6_part1_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_IP6_part2_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_IP6_part3_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_IP6_part4_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Mu12_IP6_part5_v2")     {if (MuThresh<0 || MuThresh>12) MuThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part0_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}  // Run A
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part1_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part2_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part3_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part4_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Mu10p5_IP3p5_part5_v1") {if (MuThresh<0 || MuThresh>10) MuThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part0_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}   // Run A
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part1_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part2_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part3_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part4_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part5_v1")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part0_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}   // Run A
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part1_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part2_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part3_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part4_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part5_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part0_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}   // Run B
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part1_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part2_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part3_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part4_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP6_part5_v3")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part0_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}   // Run B
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part1_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part2_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part3_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part4_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu9_IP5_part5_v2")      {if (MuThresh<0 || MuThresh>9) MuThresh=9;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP6_part3_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // ??
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP5_part3_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // ??
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part0_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // Run A
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part1_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part2_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part3_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part4_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part5_v1")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part0_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // Run A
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part1_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part2_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part3_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part4_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part5_v2")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part0_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // Run B
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part1_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part2_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part3_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part4_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8_IP3_part5_v3")      {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part0_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}   // Run A 
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part1_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part2_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part3_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part4_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu8p5_IP3p5_part5_v1")  {if (MuThresh<0 || MuThresh>8) MuThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part0_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}   // Run B
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part1_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part2_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part3_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part4_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}
                    else if (trigNames.triggerName(i)=="HLT_Mu7_IP4_part5_v2")      {if (MuThresh<0 || MuThresh>7) MuThresh=7;}

		    else BParkTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for BTau dataset has fired
                    if (BParkTrigThis) BParkingTrig = true; 
        
	          }
                }


                // set MuThresh for L1/L2/Iso for events which did not set it directly
                if (MuThresh<-48 && MuL1Thresh==0)   MuThresh=-48;
                if (MuThresh<-47 && MuL1Thresh>0)    MuThresh=-47;
                if (MuThresh<-46 && MuL2Thresh>0)    MuThresh=-46;
                if (MuThresh<-45 && IsoMuThresh>-49) MuThresh=-45;
                if (MuThresh<-44 && IsoMuThresh>0)   MuThresh=-44;
                // so the events remaining at MuThresh=-49 for Mu sample should be DoubleMuThresh events ...

                // is this the right place? what e.g. about mu/had triggers in 2011?
	        //h151->Fill(MuThresh);		// fill single mu trigger threshold flag
	        //h152->Fill(IsoMuThresh);	// fill isolated single mu trigger threshold flag
	        //h153->Fill(DoubleMuThresh);	// fill double mu trigger threshold flag
	        //h154->Fill(JpsiThresh);		// fill Jpsi trigger threshold flag
                //h161->Fill(MuHadFlag);          // fill MuHad event type flag

                // *** the following lines are old obsolete logic ***
                // should select:
                // Mu dataset: 
                //     Muthresh>2 or IsoMuthresh>2 or DoubleMuthresh>2
                //     including veto on exclusive Mu+X triggers, *not* counting low pt/Jpsi triggers
                // MuOnia dataset:
                //     (0 < Muthresh < 3 or Doublemuthresh>-1 or Jpsithresh>-1) and not 
                //     (Muthresh>2 or IsoMuthresh>2 or DoubleMuthresh>2)
                //     no veto on exclusive mu+X triggers
                //     do not select on "good" high pt mu triggers to avoid overlap with mu sample
                // 

                // debug  print 
		//     		std::cout<<"MuThresh "<<MuThresh<<" IsoMuThresh "<<IsoMuThresh<<" DoubleMuThresh "<<DoubleMuThresh<<" JpsiThresh "<<JpsiThresh<<std::endl;

		//  for the moment any positive muon triggers are OK. Additional Mu+jet triggers and triggers from the BTau sample can be accepted via the 
                //  GoodJetTrig flag
                //  negative DoubleMuThresh values to be treated;
                //  beware, can e.g. not use trimuon trigger for NMB!? 
                if ( MuThresh > -1 || IsoMuThresh > -1 || MuHadFlag > -1 || DoubleMuThresh > -1 || MuEGFlag>-1 || JpsiThresh > -1) {
		  GoodMuTrig = true; 
                  return true;
                }
                else if ((Mudataset || MuHaddataset || DoubleMudataset || MuEGdataset || MuOniadataset || MuMonitordataset || BParkingdataset) &&  
                         MuThresh == -49 && IsoMuThresh == -49 && MuHadFlag == -10 && DoubleMuThresh == -49 && MuEGFlag == -10 && JpsiThresh == -49) {
// activate this for debug
                  std::cout<<" ****** no muon Trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be muon data set
                  if ((dataset == "Mu" && !MuTrig) || (dataset == "MuHad" && !MuHadTrig) || (dataset == "DoubleMu" && !DoubleMuTrig) || (dataset == "MuEG" && !MuEGTrig) || (dataset == "MuOnia" && !MuOniaTrig) || (dataset == "MuMonitor" && !MuMonitorTrig)) exit(1);
#endif
                }
                return false;
}


//*************************************************************************
// ---- method called for each event to check good electron trigger ---- //
//*************************************************************************

bool NanoAnalyzer::providesGoodETrigger(const edm::Event& iEvent) {

// *************************************************************
//------------------ get and check trigger info ----------------
// *************************************************************

#ifndef CMSSW7plus
                edm::Handle<edm::TriggerResults> triggerResults;
                edm::Handle<edm::TriggerResults> triggerResultsHandle_;
                edm::InputTag trigResultsTag("TriggerResults","","HLT"); 
                iEvent.getByLabel(trigResultsTag,triggerResultsHandle_);
#endif
#ifdef CMSSW7plus
  //EDGetTokenT<edm::TriggerResults> trigTkn;
  //trigTkn = consumes< edm::TriggerResults>(edm::InputTag("TriggerResults","","HLT"));
  edm::Handle<edm::TriggerResults> triggerResultsHandle_;  
  iEvent.getByToken(trigTkn, triggerResultsHandle_);  
#endif

                // check whether trigger info was obtained successfully
                if (!triggerResultsHandle_.isValid()) {
		  std::cout << "Nano::goodTrigger: Error in getting TriggerResults product from Event!" << std::endl;
                  return false;
                }

                // get trigger names
                const edm::TriggerNames& trigNames = iEvent.triggerNames(*triggerResultsHandle_); 

//                // dump trigger information including accept flag
//                for(unsigned i= 0; i<trigNames.size(); i++) { 
//                  if (triggerResultsHandle_->accept(i)==1){
//                    std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
//                    std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
//      	    }
//                }

                // check Electron triggers
                // beware: cannot expect any particular ordering !!!
                ElectronTrig = false;
                DoubleElectronTrig = false;
                PhotonTrig = false;
                EGMonitorTrig = false;
                GoodETrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // single or double electron triggers for 2010B
                    // can occur exclusively on Electron sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in DoubleElectron sample :-)
                    bool ElectronTrigThis = true;

                    // single electron triggers
                    if      (trigNames.triggerName(i)=="HLT_Ele40_SW_L1R") {if (ElectronThresh<0 || ElectronThresh>40) ElectronThresh=40;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_SW_TighterEleId_L1R_v2") {if (ElectronThresh<0 || ElectronThresh>32) ElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele27_SW_TightCaloEleIdTrack_L1R_v1") {if (ElectronThresh<0 || ElectronThresh>27) ElectronThresh=27;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_TighterEleId_L1R_v2") {if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_TighterEleId_L1R_v3") {if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_TighterCaloIdIsol_L1R_v1") {if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_TighterCaloIdIsol_L1R_v2") {if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_CaloEleId_L1R") {if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    //else if (trigNames.triggerName(i)=="HLT_Ele17_SW_EleId_L1R") {if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TightEleId_L1R") {if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TighterEleIdIsol_L1R_v2") {if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TighterEleIdIsol_L1R_v3") {if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    //else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TightEleId_L1R") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    //else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TightEleIdIsol_L1R") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TightEleIdIsol_NoDEtaInEE_L1R") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    //else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TighterEleIdIsol_L1R") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TighterEleIdIsol_L1R_v1") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TighterEleIdIsol_L1R_v3") {if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}

                    // electron+MET triggers
                    else if (trigNames.triggerName(i)=="HLT_Ele10_MET45_v1") {if (ElectronThresh<-10) ElectronThresh=-10;}

                    // double electron triggers
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TightCaloEleId_SC8HE_L1R_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TightCaloEleId_Ele8HE_L1R_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_TightCaloEleId_Ele8HE_L1R_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle17_SW_L1R_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle15_SW_L1R_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>15) DoubleElectronThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_SW_L1R") {if (DoubleElectronThresh<0 || DoubleElectronThresh>10) DoubleElectronThresh=10;}

                    // electron+tau triggers
                    else if (trigNames.triggerName(i)=="HLT_IsoEle12_PFTau15_v1") {if (ElectronThresh<-12) ElectronThresh=-12;}
                    else if (trigNames.triggerName(i)=="HLT_IsoEle12_PFTau15_v2") {if (ElectronThresh<-12) ElectronThresh=-12;}
                    else if (trigNames.triggerName(i)=="HLT_IsoEle12_PFTau15_v3") {if (ElectronThresh<-12) ElectronThresh=-12;}

                    // electron+jet triggers   *** add also Elehad flag and jet threshold! ***
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_HT70U_L1R_v1") {if (ElectronThresh<-10) ElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_HT70U_L1R_v2") {if (ElectronThresh<-10) ElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_EleId_HT70U_L1R_v1") {if (ElectronThresh<-10) ElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_EleId_HT70U_L1R_v2") {if (ElectronThresh<-10) ElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle8_SW_HT70U_L1R_v1") {if (DoubleElectronThresh<-8) ElectronThresh=-8;}

                    else ElectronTrigThis = false;


                    // check and set whether trigger for Electron dataset has fired
                    if (ElectronTrigThis) ElectronTrig = true; 


                    // DoubleElectron triggers for 2011A
                    // can occur exclusively on DoubleElectron sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in DoubleElectron sample :-)
                    bool DoubleElectronTrigThis = true;

                    //
                    // unique single electron and electron+jet triggers on DoubleElectron sample!?
                    // not sure why, but supposed to be like that according to documentation
                    // need to fix internal logic for overlap with SingleE sample!!! (should be single E thresh) *** now exists -> simply rename DoubleElectronThrsh? ***
                    if      (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v7") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_v8") {if (DoubleElectronThresh<0 || DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v7") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v8") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Ele8_v11") {if (DoubleElectronThresh<0 || DoubleElectronThresh>11) DoubleElectronThresh=11;}

                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v7") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v8") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_v11") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}

                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v7") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v8") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_TrkIdVL_v11") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}

                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_TrkIdVL_CaloIsoVL_TrkIsoVL_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_TrkIdVL_CaloIsoVL_TrkIsoVL_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v9") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}

                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v1") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v2") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v3") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v4") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v5") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v6") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v7") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    else if (trigNames.triggerName(i)=="HLT_Ele8_CaloIdL_CaloIsoVL_Jet40_v8") {if (DoubleElectronThresh<0 || DoubleElectronThresh>8) DoubleElectronThresh=8;}
                    // inclusive dielectron or electron+photon triggers
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle45_CaloIdL_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>45) DoubleElectronThresh=45;}
		    //                    else if (trigNames.triggerName(i)=="HLT_DoubleEle33_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>33) DoubleElectronThresh=33;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdL_CaloIsoVL_SC17_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdL_CaloIsoVL_SC17_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdL_CaloIsoVL_SC17_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
		    //                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdL_CaloIsoVL_SC17_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdL_CaloIsoVL_SC17_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}
                    // 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_Ele32_CaloIdT_CaloIsoT_TrkIdT_TrkIsoT_SC17_v9") {if (DoubleElectronThresh<0||DoubleElectronThresh>32) DoubleElectronThresh=32;}

                    else if (trigNames.triggerName(i)=="HLT_Ele22_CaloIdL_CaloIsoVL_Ele15_HFT_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>22) DoubleElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v9") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}
                    // for 2011 MC 
                    else if (trigNames.triggerName(i)=="HLT_Photon20_CaloIdVT_IsoT_Ele8_CaloIdL_CaloIsoVL_v12") {if (DoubleElectronThresh<0||DoubleElectronThresh>20) DoubleElectronThresh=20;}

                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele8_CaloIdL_CaloIsoVL_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}

                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_Ele8_CaloIdT_CaloIsoVL_TrkIdVL_TrkIsoVL_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFL_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdL_CaloIsoVL_Ele15_HFT_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    // dielectron triggers with mass cut 
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v1") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_SC8_Mass30_v8") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v2") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v3") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v4") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v5") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v6") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_CaloIdVT_CaloIsoVT_TrkIdT_TrkIsoVT_Ele8_Mass30_v7") {if (DoubleElectronThresh<0||DoubleElectronThresh>17) DoubleElectronThresh=17;}
                    // inclusive trielectron triggers
                    else if (trigNames.triggerName(i)=="HLT_TripleEle10_CaloIdL_TrkIdVL_v7") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_TripleEle10_CaloIdL_TrkIdVL_v8") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_TripleEle10_CaloIdL_TrkIdVL_v9") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_v1") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_v2") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_v3") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_v4") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_v6") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_CaloIdT_TrkIdVL_v1") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle10_CaloIdL_TrkIdVL_Ele10_CaloIdT_TrkIdVL_v2") {if (DoubleElectronThresh<-10) DoubleElectronThresh=-10;}
                    else DoubleElectronTrigThis = false;

                    // check and set whether trigger for DoubleElectron dataset has fired
                    if (DoubleElectronTrigThis) DoubleElectronTrig = true; 
 


                    // EGMonitor triggers Run B
                    // should only occur exclusively when running over the EGMonitor sample, can occur non-exlusively on all samples
                    //          --  have all been checked for real occurrence in EGMonitor B sample :-)
                    bool EGMonitorTrigThis = true;
                    //
                    // *** not yet complete ***
                    // ECAL activity triggers,
                    if      (trigNames.triggerName(i)=="HLT_Activity_Ecal_SC17"){if (ElectronThresh<-17) ElectronThresh=-17;}
                    else if (trigNames.triggerName(i)=="HLT_Activity_Ecal_SC7"){if (ElectronThresh<-7) ElectronThresh=-7;}
                    else if (trigNames.triggerName(i)=="HLT_L1SingleEG8"){if (ElectronThresh<-8) ElectronThresh=-8;}
                    else if (trigNames.triggerName(i)=="HLT_L1SingleEG5"){if (ElectronThresh<-5) ElectronThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_L1SingleEG2"){if (ElectronThresh<-2) ElectronThresh=-2;}
                    // Low pt or loose electron triggers
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TightEleId_L1R"){if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TighterEleId_L1R_v1"){if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele12_SW_TighterEleId_L1R_v2"){if (ElectronThresh<0 || ElectronThresh>12) ElectronThresh=12;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_Isol_L1R_v1"){if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_Isol_L1R_v2"){if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_L1R_v1"){if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele22_SW_L1R_v2"){if (ElectronThresh<0 || ElectronThresh>22) ElectronThresh=22;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_L1R"){if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele17_SW_L1R_v2"){if (ElectronThresh<0 || ElectronThresh>17) ElectronThresh=17;}
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_L1R"){if (ElectronThresh<0 || ElectronThresh>10) ElectronThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Ele10_SW_L1R_v2"){if (ElectronThresh<0 || ElectronThresh>10) ElectronThresh=10;}
                    // low pt dielectron triggers
                    else if (trigNames.triggerName(i)=="HLT_L1DoubleEG5"){if (DoubleElectronThresh<0 || DoubleElectronThresh>5) DoubleElectronThresh=5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle5_SW_Upsilon_L1R_v1"){if (DoubleElectronThresh<-5) DoubleElectronThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle5_SW_Upsilon_L1R_v2"){if (DoubleElectronThresh<-5) DoubleElectronThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle4_SW_eeRes_L1R"){if (DoubleElectronThresh<0 || DoubleElectronThresh>4) DoubleElectronThresh=4;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleEle4_SW_eeRes_L1R_v2"){if (DoubleElectronThresh<0 || DoubleElectronThresh>4) DoubleElectronThresh=4;}
                    // low pt or lower quality photon triggers
                    else if (trigNames.triggerName(i)=="HLT_Photon50_NoHE_L1R"){if (PhotonThresh<0 || PhotonThresh>50) PhotonThresh=50;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_NoHE_L1R"){if (PhotonThresh<0 || PhotonThresh>20) PhotonThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon20_Isol_Cleaned_L1R_v1"){if (PhotonThresh<0 || PhotonThresh>20) PhotonThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_Photon15_Cleaned_L1R"){if (PhotonThresh<0 || PhotonThresh>10) PhotonThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_Photon10_Cleaned_L1R"){if (PhotonThresh<0 || PhotonThresh>10) PhotonThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_DoublePhoton15_L1R"){if (PhotonThresh<0 || PhotonThresh>15) PhotonThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_DoublePhoton10_L1R"){if (PhotonThresh<0 || PhotonThresh>10) PhotonThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_DoublePhoton5_L1R"){if (PhotonThresh<0 || PhotonThresh>5) PhotonThresh=5;}
                    else EGMonitorTrigThis = false;  // none of the above fired

                    // check and set whether trigger for EGMonitor dataset has fired
                    if (EGMonitorTrigThis) EGMonitorTrig = true; 


	          } // if accept
                }  // for trigger



                // is this the right place? what e.g. about E/had triggers in 2011?
                //h163->Fill(DoubleElectronThresh); // fill double electron trigger threshold flag

                // debug  print 
		//     		std::cout<<"MuThresh "<<MuThresh<<" IsoMuThresh "<<IsoMuThresh<<" DoubleMuThresh "<<DoubleMuThresh<<" JpsiThresh "<<JpsiThresh<<std::endl;

		//  for the moment any positive muon triggers are OK. Additional Mu+jet triggers and triggers from the BTau sample can be accepted via the 
                //  GoodJetTrig flag
                if ( ElectronThresh> -1 || DoubleElectronThresh > -1) {
		  GoodETrig = true; 
                  return true;
                }
                else if ((Electrondataset || DoubleElectrondataset || EGMonitordataset || Photondataset) && (ElectronThresh == -49 && DoubleElectronThresh == -49 && PhotonThresh == -49)) {
// activate this for debug
                  std::cout<<" ****** no electron or photon Trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be electron data set
                  if ((dataset == "Electron" && !ElectronTrig)) exit(1);
                  // abort the job if known to be double electron data set
                  if ((dataset == "DoubleElectron" && !DoubleElectronTrig)) exit(1);
                  // abort the job if known to be EGMonitor data set
                  if ((dataset == "EGMonitor" && !EGMonitorTrig)) exit(1);
                  // abort the job if known to be Photon data set
                  if ((dataset == "Photon" && !PhotonTrig)) exit(1);
#endif
                }
                return false;
}





bool NanoAnalyzer::providesGoodJetTrigger(const edm::Event& iEvent) {

// *************************************************************
//------------------ get and check trigger info ----------------
// *************************************************************

#ifndef CMSSW7plus
                edm::Handle<edm::TriggerResults> triggerResults;
                edm::Handle<edm::TriggerResults> triggerResultsHandle_;
                edm::InputTag trigResultsTag("TriggerResults","","HLT"); 
                iEvent.getByLabel(trigResultsTag,triggerResultsHandle_);
#endif
#ifdef CMSSW7plus
  //EDGetTokenT<edm::TriggerResults> trigTkn;
  //trigTkn = consumes< edm::TriggerResults>(edm::InputTag("TriggerResults","","HLT"));
  edm::Handle<edm::TriggerResults> triggerResultsHandle_;  
  iEvent.getByToken(trigTkn, triggerResultsHandle_);  
#endif

                // check whether trigger info was obtained successfully
                if (!triggerResultsHandle_.isValid()) {
		  std::cout << "Nano::goodTrigger: Error in getting TriggerResults product from Event!" << std::endl;
                  return false;
                }

                // get trigger names
                const edm::TriggerNames& trigNames = iEvent.triggerNames(*triggerResultsHandle_); 

                // put comments here

                // check Jet triggers
                // beware: cannot expect any particular ordering !!!
                JetTrig = false;
                GoodJetTrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check Jet triggers
                    // can occur exclusively on jet sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in jet sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool JetTrigThis = true;
                    
                    // dijet triggers
                    if      (trigNames.triggerName(i)=="HLT_DiJetAve15U_v3")  {if (DiJetThresh<0 || DiJetThresh>15)  DiJetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve15U")     {if (DiJetThresh<0 || DiJetThresh>15)  DiJetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30U_v3")  {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30U")     {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve50U_v3")  {if (DiJetThresh<0 || DiJetThresh>50)  DiJetThresh=50;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve50U")     {if (DiJetThresh<0 || DiJetThresh>50)  DiJetThresh=50;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve70U_v3")  {if (DiJetThresh<0 || DiJetThresh>70)  DiJetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve70U_v2")  {if (DiJetThresh<0 || DiJetThresh>70)  DiJetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve70U")     {if (DiJetThresh<0 || DiJetThresh>70)  DiJetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve100U_v3") {if (DiJetThresh<0 || DiJetThresh>100) DiJetThresh=100;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve100U_v1") {if (DiJetThresh<0 || DiJetThresh>100) DiJetThresh=100;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve140U_v3") {if (DiJetThresh<0 || DiJetThresh>140) DiJetThresh=140;}
                    // for 2011 MC
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v10")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v10")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v10")   {if (DiJetThresh<0 || DiJetThresh>110)  DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v10")   {if (DiJetThresh<0 || DiJetThresh>190)  DiJetThresh=190;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v10")   {if (DiJetThresh<0 || DiJetThresh>240)  DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v11")   {if (DiJetThresh<0 || DiJetThresh>300)  DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve370_v11")   {if (DiJetThresh<0 || DiJetThresh>370)  DiJetThresh=370;}

                    // for 2011 data                                                                                                  //  seed
                    // note that prescales correlate if and only if the L1 seeds are the same
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve15U_v4")  {if (DiJetThresh<0 || DiJetThresh>15)  DiJetThresh=15;} // L1_SingleJet16
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v6")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;} // L1_SingleJet16
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v5")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v4")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v3")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v2")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30_v1")   {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve30U_v4")  {if (DiJetThresh<0 || DiJetThresh>30)  DiJetThresh=30;} // L1_SingleJet36
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve50U_v4")  {if (DiJetThresh<0 || DiJetThresh>50)  DiJetThresh=50;} // L1_SingleJet52
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v6")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;} // L1_SingleJet36
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v5")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v4")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v3")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v2")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve60_v1")   {if (DiJetThresh<0 || DiJetThresh>60)  DiJetThresh=60;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve70U_v4")  {if (DiJetThresh<0 || DiJetThresh>70)  DiJetThresh=70;} // L1_SingleJet68
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v6")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;} // L1_SingleJet52
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v5")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v4")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v3")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v2")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve80_v1")   {if (DiJetThresh<0 || DiJetThresh>80)  DiJetThresh=80;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve100U_v4") {if (DiJetThresh<0 || DiJetThresh>100) DiJetThresh=100;} //L1_SingleJet92
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v6")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;} //L1_SingleJet68
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v5")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v4")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v3")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v2")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve110_v1")  {if (DiJetThresh<0 || DiJetThresh>110) DiJetThresh=110;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve140U_v4") {if (DiJetThresh<0 || DiJetThresh>140) DiJetThresh=140;} //L1_SingleJet92
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v6")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;} //L1_SingleJet92
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v5")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v4")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v3")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v2")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve150_v1")  {if (DiJetThresh<0 || DiJetThresh>150) DiJetThresh=150;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve180U_v4") {if (DiJetThresh<0 || DiJetThresh>180) DiJetThresh=180;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v6")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;} //L1_SingleJet92
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v5")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;} //     ...
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v4")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v3")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v2")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve190_v1")  {if (DiJetThresh<0 || DiJetThresh>190) DiJetThresh=190;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v6")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v5")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v4")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v3")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v2")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve240_v1")  {if (DiJetThresh<0 || DiJetThresh>240) DiJetThresh=240;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v6")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v5")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v4")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v3")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v2")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}
                    else if (trigNames.triggerName(i)=="HLT_DiJetAve300_v1")  {if (DiJetThresh<0 || DiJetThresh>300) DiJetThresh=300;}

                    // single jet triggers
                    else if (trigNames.triggerName(i)=="HLT_Jet15U_v3")  {if (JetThresh<0 || JetThresh>15) JetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_Jet15U")     {if (JetThresh<0 || JetThresh>15) JetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_Jet30U_v3")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_Jet30U")     {if (JetThresh<0 || JetThresh>30) JetThresh=30;} 
                    else if (trigNames.triggerName(i)=="HLT_Jet50U_v3")  {if (JetThresh<0 || JetThresh>50) JetThresh=50;}
                    else if (trigNames.triggerName(i)=="HLT_Jet50U")     {if (JetThresh<0 || JetThresh>50) JetThresh=50;}
                    else if (trigNames.triggerName(i)=="HLT_Jet70U_v3")  {if (JetThresh<0 || JetThresh>70) JetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_Jet70U_v2")  {if (JetThresh<0 || JetThresh>70) JetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_Jet70U")     {if (JetThresh<0 || JetThresh>70) JetThresh=70;}
                    else if (trigNames.triggerName(i)=="HLT_Jet100U_v3") {if (JetThresh<0 || JetThresh>100) JetThresh=100;}
		    else if (trigNames.triggerName(i)=="HLT_Jet100U_v2") {if (JetThresh<0 || JetThresh>100) JetThresh=100;}
		    else if (trigNames.triggerName(i)=="HLT_Jet140U_v3") {if (JetThresh<0 || JetThresh>140) JetThresh=140;}
                    //else if (trigNames.triggerName(i)=="HLT_Jet180U")    {if (JetThresh<0 || JetThresh>180) JetThresh=180;}

                    // for 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v10")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v10")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
                    // for 2011 data
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v6")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v5")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v4")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v3")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v2")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet30_v1")  {if (JetThresh<0 || JetThresh>30) JetThresh=30;} // seed: L1_SingleJet16
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v6")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v5")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v4")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v3")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v2")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;}
		    else if (trigNames.triggerName(i)=="HLT_Jet60_v1")  {if (JetThresh<0 || JetThresh>60) JetThresh=60;} // seed: L1_SingleJet36
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v6")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;}
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v5")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;}
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v4")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;}
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v3")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;}
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v2")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;}
		    else if (trigNames.triggerName(i)=="HLT_Jet80_v1")  {if (JetThresh<0 || JetThresh>80) JetThresh=80;} // seed: L1_SingleJet52
                    // 2011 MC 
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v10") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}

		    else if (trigNames.triggerName(i)=="HLT_Jet110_v6") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v5") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v4") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v3") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v2") {if (JetThresh<0 || JetThresh>110) JetThresh=110;}
		    else if (trigNames.triggerName(i)=="HLT_Jet110_v1") {if (JetThresh<0 || JetThresh>110) JetThresh=110;} // seed: L1_SingleJet68
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v6") {if (JetThresh<0 || JetThresh>150) JetThresh=150;}
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v5") {if (JetThresh<0 || JetThresh>150) JetThresh=150;}
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v4") {if (JetThresh<0 || JetThresh>150) JetThresh=150;}
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v3") {if (JetThresh<0 || JetThresh>150) JetThresh=150;}
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v2") {if (JetThresh<0 || JetThresh>150) JetThresh=150;}
		    else if (trigNames.triggerName(i)=="HLT_Jet150_v1") {if (JetThresh<0 || JetThresh>150) JetThresh=150;} // seed: L1_SingleJet92
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v10") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}

		    else if (trigNames.triggerName(i)=="HLT_Jet190_v6") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v5") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v4") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v3") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v2") {if (JetThresh<0 || JetThresh>190) JetThresh=190;}
		    else if (trigNames.triggerName(i)=="HLT_Jet190_v1") {if (JetThresh<0 || JetThresh>190) JetThresh=190;} // seed: L1_SingleJet92
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v10") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}

		    else if (trigNames.triggerName(i)=="HLT_Jet240_v6") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v5") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v4") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v3") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v2") {if (JetThresh<0 || JetThresh>240) JetThresh=240;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_v1") {if (JetThresh<0 || JetThresh>240) JetThresh=240;} // seed: L1_SingleJet92
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Jet300_v10") {if (JetThresh<0 || JetThresh>300) JetThresh=300;} //       ...

		    else if (trigNames.triggerName(i)=="HLT_Jet300_v5") {if (JetThresh<0 || JetThresh>300) JetThresh=300;} //       ...
		    else if (trigNames.triggerName(i)=="HLT_Jet300_v4") {if (JetThresh<0 || JetThresh>300) JetThresh=300;}
		    else if (trigNames.triggerName(i)=="HLT_Jet300_v3") {if (JetThresh<0 || JetThresh>300) JetThresh=300;}
		    else if (trigNames.triggerName(i)=="HLT_Jet300_v2") {if (JetThresh<0 || JetThresh>300) JetThresh=300;}
		    else if (trigNames.triggerName(i)=="HLT_Jet300_v1") {if (JetThresh<0 || JetThresh>300) JetThresh=300;} 
                    // 2011 MC
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v11") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}

		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v6") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v5") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v4") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v3") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v2") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
		    else if (trigNames.triggerName(i)=="HLT_Jet370_NoJetID_v1") {if (JetThresh<0 || JetThresh>370) JetThresh=370;}
                    // for 2011 data, with BTag, set BThresh instead?
		    else if (trigNames.triggerName(i)=="HLT_Jet240_CentralJet30_BTagIP_v3") {if (JetThresh<-30) JetThresh=-30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_CentralJet30_BTagIP_v2") {if (JetThresh<-30) JetThresh=-30;}
		    else if (trigNames.triggerName(i)=="HLT_Jet240_CentralJet30_BTagIP_v1") {if (JetThresh<-30) JetThresh=-30;}
                    // HT based triggers 
                    else if (trigNames.triggerName(i)=="HLT_HT100U")     {if (HTThresh<0  || HTThresh>100) HTThresh=100;}  // moved from JetMET, 
                                                                                                                           // overlap with JetMETTauMonitor
                    //else if (trigNames.triggerName(i)=="HLT_HT120U")     {if (HTThresh<0  || HTThresh>120) HTThresh=120;}  // moved to JetMETTauMonitor 
                    //else if (trigNames.triggerName(i)=="HLT_HT140U")     {if (HTThresh<0  || HTThresh>140) HTThresh=140;}  // moved to MultiJet
                    else if (trigNames.triggerName(i)=="HLT_EcalOnly_SumEt160") {if (HTThresh<0  || HTThresh>160) HTThresh=160;}  // moved from JetMET
                    // four-jet triggers (e.g. for hadronic top)
                    else if (trigNames.triggerName(i)=="HLT_QuadJet20U") {if (QuadJetThresh<0  || QuadJetThresh>20) QuadJetThresh=20;}  // overlap with MultiJet
                    //else if (trigNames.triggerName(i)=="HLT_QuadJet25U") {if (QuadJetThresh<0  || QuadJetThresh>25) QuadJetThresh=25;} // seemingly never unique

		    else JetTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for Jet dataset has fired
                    if (JetTrigThis) JetTrig = true; 
        
	          }
                }

                // put comments here

                // check MultiJet triggers
                // beware: cannot expect any particular ordering !!!
                MultiJetTrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check MultiJet triggers
                    // can occur exclusively on MultiJet sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in MultiJet sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool MultiJetTrigThis = true;
                    
                    // dijet triggers
                    if      (trigNames.triggerName(i)=="HLT_ExclDiJet30U_HFOR_v3")  {if (DiJetThresh<0 || DiJetThresh>30) DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_ExclDiJet30U_HFOR_v1")  {if (DiJetThresh<0 || DiJetThresh>30) DiJetThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_ExclDiJet30U_HFAND_v3") {if (DiJetThresh<0 || DiJetThresh>30) DiJetThresh=30;}
                    //else if (trigNames.triggerName(i)=="HLT_DiJet20U_Meff180U")     {if (DiJetThresh<0 || DiJetThresh>20) DiJetThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_DiJet50U_PT50U_v3")     {if (DiJetThresh<0 || DiJetThresh>50) DiJetThresh=50;}
                    //else if (trigNames.triggerName(i)=="HLT_R030U_MR100U")          {if (DiJetThresh<0 || DiJetThresh>50) DiJetThresh=50;}
                    //else if (trigNames.triggerName(i)=="HLT_R033U_MR100U")          {if (DiJetThresh<0 || DiJetThresh>50) DiJetThresh=50;}
                    // HT based triggers 
                    else if (trigNames.triggerName(i)=="HLT_HT100U_v3")           {if (HTThresh<0  || HTThresh>100) HTThresh=100;} // no overlap (v3!)
                    else if (trigNames.triggerName(i)=="HLT_HT130U_v3")           {if (HTThresh<0  || HTThresh>130) HTThresh=130;} 
                    else if (trigNames.triggerName(i)=="HLT_HT140U")              {if (HTThresh<0  || HTThresh>140) HTThresh=140;}  
                    else if (trigNames.triggerName(i)=="HLT_HT140U_eta3_v3")      {if (HTThresh<0  || HTThresh>140) HTThresh=140;}  
                    else if (trigNames.triggerName(i)=="HLT_HT140U_J30U_Eta3_v3") {if (HTThresh<0  || HTThresh>140) HTThresh=140;}  
                    else if (trigNames.triggerName(i)=="HLT_HT150U_v3")           {if (HTThresh<0  || HTThresh>140) HTThresh=150;}  
                    //else if (trigNames.triggerName(i)=="HLT_HT150U_eta3")         {if (HTThresh<0  || HTThresh>150) HTThresh=150;}  
                    //else if (trigNames.triggerName(i)=="HLT_HT160U")              {if (HTThresh<0  || HTThresh>140) HTThresh=160;}  
                    //else if (trigNames.triggerName(i)=="HLT_HT160U_eta3")         {if (HTThresh<0  || HTThresh>160) HTThresh=160;}  
                    //else if (trigNames.triggerName(i)=="HLT_HT200U")              {if (HTThresh<0  || HTThresh>200) HTThresh=200;}  
                    else if (trigNames.triggerName(i)=="HLT_EcalOnly_SumEt160_v3"){if (HTThresh<0  || HTThresh>160) HTThresh=160;} // no overlap (v3!)
                    else if (trigNames.triggerName(i)=="HLT_EcalOnly_SumEt160_v2"){if (HTThresh<0  || HTThresh>160) HTThresh=160;} // no overlap (v2!)
                    // four-jet triggers (e.g. for hadronic top)
                    else if (trigNames.triggerName(i)=="HLT_QuadJet20U_v3") {if (QuadJetThresh<0  || QuadJetThresh>20) QuadJetThresh=20;} // no overlap (v3!)
                    else if (trigNames.triggerName(i)=="HLT_QuadJet20U_v2") {if (QuadJetThresh<0  || QuadJetThresh>20) QuadJetThresh=20;} // no overlap (v2!)
                    else if (trigNames.triggerName(i)=="HLT_QuadJet25U_v3") {if (QuadJetThresh<0  || QuadJetThresh>25) QuadJetThresh=25;}

		    else MultiJetTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for MultiJet dataset has fired
                    if (MultiJetTrigThis) MultiJetTrig = true; 
        
	          }
                }

                // put comments here

                // check JetMETTauMonitor triggers
                // beware: cannot expect any particular ordering !!!
                JetMETTauMonitorTrig = false;
                // ... to be treated ...
                METFwdTrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check Jet triggers
                    // can occur exclusively on JetMETTauMonitor sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in JetMETTauMonitor sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool JetMETTauMonitorTrigThis = true;
                    
                    // dijet triggers
                    if      (trigNames.triggerName(i)=="HLT_R010U_MR50U")   {if (DiJetThresh<0 || DiJetThresh>50) DiJetThresh=50;}
                    // single Jet triggers
                    else if (trigNames.triggerName(i)=="HLT_L1Jet10U")      {if (JetThresh<0 || JetThresh>10) JetThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_L1Jet6U")       {if (JetThresh<0 || JetThresh>6) JetThresh=6;}
                    // HT based triggers 
                    else if (trigNames.triggerName(i)=="HLT_HT50U_v3")      {if (HTThresh<0  || HTThresh>50) HTThresh=50;}  
                    else if (trigNames.triggerName(i)=="HLT_HT50U_v1")      {if (HTThresh<0  || HTThresh>50) HTThresh=50;}  
                    else if (trigNames.triggerName(i)=="HLT_HT100U")        {if (HTThresh<0  || HTThresh>100) HTThresh=100;}    // overlap with Jet 
                    else if (trigNames.triggerName(i)=="HLT_HT120U")        {if (HTThresh<0  || HTThresh>120) HTThresh=120;}    // not in list, moved from Jet 
                    else if (trigNames.triggerName(i)=="HLT_L1ETT100")      {if (HTThresh<0  || HTThresh>105) HTThresh=105;}    // not in list, moved from JetMET
                    else if (trigNames.triggerName(i)=="HLT_L1ETT140_v1")   {if (HTThresh<0  || HTThresh>145) HTThresh=145;}  
                    // four-jet triggers (e.g. for hadronic top)
                    else if (trigNames.triggerName(i)=="HLT_QuadJet15U_v3") {if (QuadJetThresh<0  || QuadJetThresh>15) QuadJetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_QuadJet15U_v2") {if (QuadJetThresh<0  || QuadJetThresh>15) QuadJetThresh=15;}
                    else if (trigNames.triggerName(i)=="HLT_QuadJet15U")    {if (QuadJetThresh<0  || QuadJetThresh>15) QuadJetThresh=15;}
                    // Missing ET triggers 
                    else if (trigNames.triggerName(i)=="HLT_L1MET20")       {if (METThresh<0  || METThresh>20) METThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_MET45_v3")      {if (METThresh<0  || METThresh>45) METThresh=45;}

		    else JetMETTauMonitorTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for JetMETTauMonitor dataset has fired
                    if (JetMETTauMonitorTrigThis) JetMETTauMonitorTrig = true; 
        
	          }
                }

                // put comments here

                // check BTau triggers
                // beware: cannot expect any particular ordering !!!
                BTauTrig = false;

                for(unsigned i= 0; i<trigNames.size(); i++) { 
                  if (triggerResultsHandle_->accept(i)==1){

                    // check BTau triggers
                    // can occur exclusively on BTau sample only, but can also occur on other samples if non-exclusive
                    //          --  have all been checked for real occurrence in BTau sample :-)
                    //              the ones which are commented out without comment have been listed but do not occur 
                    bool BTauTrigThis = true;
                    
                    // combined triggers    *** thresholds still need to be defined properly
                    if      (trigNames.triggerName(i)=="HLT_SingleIsoTau30_Trk5_v2")         {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau30_Trk5_L120or30")   {if (METThresh<-30) METThresh=-30;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau30_Trk5_MET20")      {if (METThresh<-20) METThresh=-20;}
                    //else if (trigNames.triggerName(i)=="HLT_SingleIsoTau35_Trk15_MET25")     {if (METThresh<-25) METThresh=-25;}
                    //else if (trigNames.triggerName(i)=="HLT_SingleLooseIsoTau25_Trk5")       {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk15_MET25_v4")  {if (METThresh<-25) METThresh=-25;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk15_MET25_v3")  {if (METThresh<-25) METThresh=-25;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk15_MET20")     {if (METThresh<-20) METThresh=-20;}
                    //else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk5")            {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk5_MET20")      {if (METThresh<-20) METThresh=-20;}
                    //else if (trigNames.triggerName(i)=="HLT_SingleIsoTau20_Trk5_MET25")      {if (METThresh<-25) METThresh=-25;}
                    //else if (trigNames.triggerName(i)=="HLT_SingleLooseIsoTau20")            {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_OneLeg_Trk5_v4")  {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_OneLeg_Trk5_v3")  {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_OneLeg_Trk5")     {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_Trk5_v4")         {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_Trk5_v3")         {if (METThresh<-5) METThresh=-5;}
                    else if (trigNames.triggerName(i)=="HLT_DoubleIsoTau15_Trk5")            {if (METThresh<-5) METThresh=-5;}
                    //else if (trigNames.triggerName(i)=="HLT_DoubleLooseIsoTau15")            {if (METThresh<-15) METThresh=-15;}
                    // B tag dijet triggers
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet30U_Mu5_v3") {if (BThresh<0  || BThresh>30) BThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet30U_v3")     {if (BThresh<0  || BThresh>30) BThresh=30;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet20U_v3")     {if (BThresh<0  || BThresh>20) BThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet20U_v1")     {if (BThresh<0  || BThresh>20) BThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet20U_Mu5_v3") {if (BThresh<0  || BThresh>20) BThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet20U_Mu5_v1") {if (BThresh<0  || BThresh>20) BThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet10U_v3")     {if (BThresh<0  || BThresh>10) BThresh=10;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_DiJet10U_v1")     {if (BThresh<0  || BThresh>10) BThresh=10;}
                    // B tag single jet trigger
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_Jet20U")          {if (BThresh<0  || BThresh>20) BThresh=20;}
                    else if (trigNames.triggerName(i)=="HLT_BTagMu_Jet10U")          {if (BThresh<0  || BThresh>10) BThresh=10;}
                    // B tag inclusive impact parameter trigger (no muon)
                    //else if (trigNames.triggerName(i)=="HLT_BTagIP_Jet50U")          {if (BThresh<0  || BThresh>50) BThresh=50;}
                    
		    else BTauTrigThis = false;  // none of the above has triggered

                    // check and set whether trigger for BTau dataset has fired
                    if (BTauTrigThis) BTauTrig = true; 
        
	          }
                }


	        //h155->Fill(JetThresh);		// fill single jet trigger threshold flag
	        //h156->Fill(DiJetThresh);	// fill dijet trigger threshold flag
	        //h157->Fill(QuadJetThresh);	        // fill HT trigger threshold flag
	        //h158->Fill(HTThresh);	        // fill HT trigger threshold flag
	        //h159->Fill(BThresh);	        // fill B trigger threshold flag
	        //h160->Fill(METThresh);	        // fill B trigger threshold flag
 
                // debug  print 
		// std::cout<<"JetThresh "<<JetThresh<<" DiJetThresh "<<DiJetThresh<<" QuadJetThresh "<<QuadJetThresh<<" HTThresh "<<HTThresh<<" BThresh "<< BThresh<<std::endl;

		//  for the moment any positive triggers except missing ET are OK
                if ( JetThresh > -1 || DiJetThresh > -1 || QuadJetThresh >-1 || HTThresh>-1 || BThresh>-1) {
		  GoodJetTrig = true; 
                  return true;
                }
                else if ((Jetdataset) &&  
                         JetThresh == -199 && DiJetThresh == -199 && QuadJetThresh ==-199 && HTThresh ==-199) {
// activate this for debug
                  std::cout<<" ****** no jet trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be jet data set
                  if (dataset == "Jet" && !JetTrig) exit(1);
#endif
                }
                else if ((MultiJetdataset) &&  
                         JetThresh == -199 && DiJetThresh == -199 && QuadJetThresh ==-199 && HTThresh ==-199) {
// activate this for debug
                  std::cout<<" ****** no MultiJet trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be jet data set
                  if (dataset == "MultiJet" && !MultiJetTrig) exit(1);
#endif
                }
                else if ((JetMETTauMonitordataset) &&  
                         JetThresh == -199 && DiJetThresh == -199 && QuadJetThresh ==-199 && HTThresh ==-199 && METThresh == -199) {
// activate this for debug
                  std::cout<<" ****** no JETMETTauMonitor trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be jet data set
                  if (dataset == "JetMETTauMonitor" && !JetMETTauMonitorTrig) exit(1);
#endif
                }
                else if ((BTaudataset) &&  
                         JetThresh == -199 && DiJetThresh == -199 && QuadJetThresh ==-199 && HTThresh ==-199 && BThresh == -199 && METThresh == -199) {
// activate this for debug
                  std::cout<<" ****** no BTau trigger recognized ****** "<<std::endl;
                  for(unsigned i= 0; i<trigNames.size(); i++) {
                    // dump only accepted triggers 
                    if (triggerResultsHandle_->accept(i)==1){
                      std::cout<<" Trigger name "<<trigNames.triggerName(i)<<", Accepted = ";
                      std::cout<<triggerResultsHandle_->accept(i)<<std::endl;
	            }
                  }
#ifdef trigcheckabort
                  // abort the job if known to be jet data set
                  if (dataset == "BTau" && !BTauTrig) exit(1);
#endif
                }

                return false;
}

